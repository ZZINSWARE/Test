-- ZZINSWARE V4: Full Featured Script Hub with Lua Syntax Highlighting
-- Features: Discord Integration, Auto-Update Stats, Lua Highlighter, Version Badge, Credits, System Monitor, Error Notifications, Settings

local highlighter = {}
local keywords = {
	lua = {
		"and", "break", "or", "else", "elseif", "if", "then", "until", "repeat", "while", "do", "for", "in", "end",
		"local", "return", "function", "export"
	},
	rbx = {
		"game", "workspace", "script", "math", "string", "table", "task", "wait", "select", "next", "Enum",
		"error", "warn", "tick", "assert", "shared", "loadstring", "tonumber", "tostring", "type",
		"typeof", "unpack", "print", "Instance", "CFrame", "Vector3", "Vector2", "Color3", "UDim", "UDim2", "Ray", "BrickColor",
		"OverlapParams", "RaycastParams", "Axes", "Random", "Region3", "Rect", "TweenInfo",
		"collectgarbage", "not", "utf8", "pcall", "xpcall", "_G", "setmetatable", "getmetatable", "os", "pairs", "ipairs"
	},
	operators = {
		"#", "+", "-", "*", "%", "/", "^", "=", "~", "=", "<", ">", ",", ".", "(", ")", "{", "}", "[", "]", ";", ":"
	}
}

local colors = {
	numbers = Color3.fromRGB(255, 198, 0),
	boolean = Color3.fromRGB(214, 128, 23),
	operator = Color3.fromRGB(232, 210, 40),
	lua = Color3.fromRGB(160, 87, 248),
	rbx = Color3.fromRGB(146, 180, 253),
	str = Color3.fromRGB(56, 241, 87),
	comment = Color3.fromRGB(103, 110, 149),
	null = Color3.fromRGB(79, 79, 79),
	call = Color3.fromRGB(130, 170, 255),
	self_call = Color3.fromRGB(227, 201, 141),
	local_color = Color3.fromRGB(199, 146, 234),
	function_color = Color3.fromRGB(241, 122, 124),
	self_color = Color3.fromRGB(146, 134, 234),
	local_property = Color3.fromRGB(129, 222, 255),
}

local function createKeywordSet(keywords)
	local keywordSet = {}
	for _, keyword in ipairs(keywords) do
		keywordSet[keyword] = true
	end
	return keywordSet
end

local luaSet = createKeywordSet(keywords.lua)
local rbxSet = createKeywordSet(keywords.rbx)
local operatorsSet = createKeywordSet(keywords.operators)

local function getHighlight(tokens, index)
	local token = tokens[index]

	if colors[token .. "_color"] then
		return colors[token .. "_color"]
	end

	if tonumber(token) then
		return colors.numbers
	elseif token == "nil" then
		return colors.null
	elseif token:sub(1, 2) == "--" then
		return colors.comment
	elseif operatorsSet[token] then
		return colors.operator
	elseif luaSet[token] then
		return colors.rbx
	elseif rbxSet[token] then
		return colors.lua
	elseif token:sub(1, 1) == "\"" or token:sub(1, 1) == "\'" then
		return colors.str
	elseif token == "true" or token == "false" then
		return colors.boolean
	end

	if tokens[index + 1] == "(" then
		if tokens[index - 1] == ":" then
			return colors.self_call
		end

		return colors.call
	end

	if tokens[index - 1] == "." then
		if tokens[index - 2] == "Enum" then
			return colors.rbx
		end

		return colors.local_property
	end
end

-- OPTIMIZED: Support for thousands of characters with chunking
function highlighter.run(source)
	-- Limit processing for very large scripts to prevent lag
	local maxLength = 50000
	local processSource = source
	
	if #source > maxLength then
		processSource = source:sub(1, maxLength)
	end
	
	local tokens = {}
	local currentToken = ""
	
	local inString = false
	local inComment = false
	local commentPersist = false
	
	for i = 1, #processSource do
		local character = processSource:sub(i, i)
		
		if inComment then
			if character == "\n" and not commentPersist then
				table.insert(tokens, currentToken)
				table.insert(tokens, character)
				currentToken = ""
				
				inComment = false
			elseif processSource:sub(i - 1, i) == "]]" and commentPersist then
				currentToken = currentToken .. "]"
				
				table.insert(tokens, currentToken)
				currentToken = ""
				
				inComment = false
				commentPersist = false
			else
				currentToken = currentToken .. character
			end
		elseif inString then
			if character == inString and processSource:sub(i-1, i-1) ~= "\\" or character == "\n" then
				currentToken = currentToken .. character
				inString = false
			else
				currentToken = currentToken .. character
			end
		else
			if processSource:sub(i, i + 1) == "--" then
				table.insert(tokens, currentToken)
				currentToken = "-"
				inComment = true
				commentPersist = processSource:sub(i + 2, i + 3) == "[["
			elseif character == "\"" or character == "\'" then
				table.insert(tokens, currentToken)
				currentToken = character
				inString = character
			elseif operatorsSet[character] then
				table.insert(tokens, currentToken)
				table.insert(tokens, character)
				currentToken = ""
			elseif character:match("[%w_]") then
				currentToken = currentToken .. character
			else
				table.insert(tokens, currentToken)
				table.insert(tokens, character)
				currentToken = ""
			end
		end
	end
	
	table.insert(tokens, currentToken)

	local highlighted = {}
	
	for i, token in ipairs(tokens) do
		local highlight = getHighlight(tokens, i)

		if highlight then
			local syntax = string.format("<font color = \"#%s\">%s</font>", highlight:ToHex(), token:gsub("<", "&lt;"):gsub(">", "&gt;"))
			
			table.insert(highlighted, syntax)
		else
			table.insert(highlighted, token)
		end
	end

	return table.concat(highlighted)
end

-- SETTINGS SYSTEM
local Settings = {
	Font = "Code",
	SyntaxHighlighting = true,
	LastScript = ""
}

local FontOptions = {
	["Original"] = Enum.Font.Code,
	["Legacy"] = Enum.Font.Legacy,
	["Code"] = Enum.Font.Code,
	["Arcade"] = Enum.Font.Arcade
}

-- ENHANCED NOTIFICATION SYSTEM
local function ShowNotification(title, message, notifType, duration)
	duration = duration or 3
	local parent = Windows11UI
	
	local NotifFrame = Instance.new("Frame")
	NotifFrame.Name = "Notification"
	NotifFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	NotifFrame.BorderSizePixel = 0
	NotifFrame.Position = UDim2.new(0.5, -200, 0, -100)
	NotifFrame.Size = UDim2.new(0, 400, 0, 70)
	NotifFrame.ZIndex = 1000
	NotifFrame.Parent = parent
	
	local NotifCorner = Instance.new("UICorner")
	NotifCorner.CornerRadius = UDim.new(0, 8)
	NotifCorner.Parent = NotifFrame
	
	local NotifStroke = Instance.new("UIStroke")
	NotifStroke.Color = notifType == "Error" and Color3.fromRGB(255, 50, 50) or Color3.fromRGB(50, 150, 255)
	NotifStroke.Thickness = 2
	NotifStroke.Parent = NotifFrame
	
	-- Gradient background
	local NotifGradient = Instance.new("UIGradient")
	NotifGradient.Color = ColorSequence.new({
		ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 30, 30)),
		ColorSequenceKeypoint.new(1, Color3.fromRGB(20, 20, 20))
	})
	NotifGradient.Rotation = 90
	NotifGradient.Parent = NotifFrame
	
	-- Icon
	local NotifIcon = Instance.new("ImageLabel")
	NotifIcon.Name = "Icon"
	NotifIcon.Parent = NotifFrame
	NotifIcon.BackgroundTransparency = 1
	NotifIcon.Position = UDim2.new(0, 15, 0.5, -20)
	NotifIcon.Size = UDim2.new(0, 40, 0, 40)
	NotifIcon.Image = notifType == "Error" and "rbxassetid://137703776500811" or "rbxassetid://9405926389"
	NotifIcon.ImageColor3 = notifType == "Error" and Color3.fromRGB(255, 100, 100) or Color3.fromRGB(100, 200, 255)
	NotifIcon.ZIndex = 1001
	
	-- Title
	local NotifTitle = Instance.new("TextLabel")
	NotifTitle.Name = "Title"
	NotifTitle.Parent = NotifFrame
	NotifTitle.BackgroundTransparency = 1
	NotifTitle.Position = UDim2.new(0, 65, 0, 8)
	NotifTitle.Size = UDim2.new(1, -75, 0, 22)
	NotifTitle.Font = Enum.Font.GothamBold
	NotifTitle.Text = title
	NotifTitle.TextColor3 = notifType == "Error" and Color3.fromRGB(255, 100, 100) or Color3.fromRGB(255, 255, 255)
	NotifTitle.TextSize = 14
	NotifTitle.TextXAlignment = Enum.TextXAlignment.Left
	NotifTitle.ZIndex = 1001
	
	-- Message
	local NotifMessage = Instance.new("TextLabel")
	NotifMessage.Name = "Message"
	NotifMessage.Parent = NotifFrame
	NotifMessage.BackgroundTransparency = 1
	NotifMessage.Position = UDim2.new(0, 65, 0, 32)
	NotifMessage.Size = UDim2.new(1, -75, 0, 30)
	NotifMessage.Font = Enum.Font.Gotham
	NotifMessage.Text = message
	NotifMessage.TextColor3 = Color3.fromRGB(180, 180, 180)
	NotifMessage.TextSize = 12
	NotifMessage.TextXAlignment = Enum.TextXAlignment.Left
	NotifMessage.TextWrapped = true
	NotifMessage.ZIndex = 1001
	
	-- Close button
	local CloseBtn = Instance.new("TextButton")
	CloseBtn.Name = "Close"
	CloseBtn.Parent = NotifFrame
	CloseBtn.BackgroundTransparency = 1
	CloseBtn.Position = UDim2.new(1, -25, 0, 5)
	CloseBtn.Size = UDim2.new(0, 20, 0, 20)
	CloseBtn.Font = Enum.Font.GothamBold
	CloseBtn.Text = "Ã—"
	CloseBtn.TextColor3 = Color3.fromRGB(150, 150, 150)
	CloseBtn.TextSize = 20
	CloseBtn.ZIndex = 1001
	
	-- Animate in
	local tweenService = game:GetService("TweenService")
	local slideIn = tweenService:Create(NotifFrame, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
		Position = UDim2.new(0.5, -200, 0, 20)
	})
	slideIn:Play()
	
	-- Error shake effect
	if notifType == "Error" then
		local shake1 = tweenService:Create(NotifFrame, TweenInfo.new(0.05), {Position = UDim2.new(0.5, -195, 0, 20)})
		local shake2 = tweenService:Create(NotifFrame, TweenInfo.new(0.05), {Position = UDim2.new(0.5, -200, 0, 20)})
		local shake3 = tweenService:Create(NotifFrame, TweenInfo.new(0.05), {Position = UDim2.new(0.5, -205, 0, 20)})
		local shake4 = tweenService:Create(NotifFrame, TweenInfo.new(0.05), {Position = UDim2.new(0.5, -200, 0, 20)})
		
		slideIn.Completed:Connect(function()
			shake1:Play()
			shake1.Completed:Connect(function()
				shake2:Play()
				shake2.Completed:Connect(function()
					shake3:Play()
					shake3.Completed:Connect(function()
						shake4:Play()
					end)
				end)
			end)
		end)
	end
	
	-- Auto remove
	local function removeNotif()
		local slideOut = tweenService:Create(NotifFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.In), {
			Position = UDim2.new(0.5, -200, 0, -100)
		})
		slideOut:Play()
		slideOut.Completed:Connect(function()
			NotifFrame:Destroy()
		end)
	end
	
	CloseBtn.MouseButton1Click:Connect(removeNotif)
	delay(duration, removeNotif)
	
	return NotifFrame
end

-- MAIN UI CREATION
local Windows11UI = Instance.new("ScreenGui")
local Topbar = Instance.new("Frame")
local UICorner = Instance.new("UICorner")
local Frame = Instance.new("Frame")
local UICorner_2 = Instance.new("UICorner")
local TabFrame = Instance.new("Frame")
local InfoTab = Instance.new("ImageButton")
local EditorTab = Instance.new("ImageButton")
local SearcherTab = Instance.new("ImageButton")
local GameScriptsTab = Instance.new("ImageButton")
local UniversalScriptsTab = Instance.new("ImageButton")
local SettingsTab = Instance.new("ImageButton")
local InfoFrame = Instance.new("Frame")
local InfoBackground = Instance.new("ImageLabel")
local DiscordLabel = Instance.new("TextLabel")
local DiscordIcon = Instance.new("ImageLabel")
local CopyDiscordBtn = Instance.new("ImageButton")
local CopyDiscordLabel = Instance.new("TextLabel")
local EditorFrame = Instance.new("Frame")
local Source = Instance.new("TextBox")
local Inject = Instance.new("ImageButton")
local Execute = Instance.new("ImageButton")
local Clear = Instance.new("ImageButton")
local Paste = Instance.new("ImageButton")
local Copy = Instance.new("ImageButton")
local OpenConsole = Instance.new("ImageButton")
local SearcherFrame = Instance.new("Frame")
local SearchBox = Instance.new("TextBox")
local SearchButton = Instance.new("ImageButton")
local FilterFrame = Instance.new("Frame")
local FreeFilter = Instance.new("TextButton")
local VerifiedFilter = Instance.new("TextButton")
local TrendingFilter = Instance.new("TextButton")
local MostViewedFilter = Instance.new("TextButton")
local UnverifiedFilter = Instance.new("TextButton")
local ScriptList = Instance.new("ScrollingFrame")
local ListLayout = Instance.new("UIListLayout")
local PageFrame = Instance.new("Frame")
local PrevPageBtn = Instance.new("ImageButton")
local PageLabel = Instance.new("TextLabel")
local NextPageBtn = Instance.new("ImageButton")
local GameScriptsFrame = Instance.new("Frame")
local GameSearchBox = Instance.new("TextBox")
local GameSearchButton = Instance.new("ImageButton")
local GameScriptsList = Instance.new("ScrollingFrame")
local GameListLayout = Instance.new("UIListLayout")
local UniversalScriptsFrame = Instance.new("Frame")
local UniSearchBox = Instance.new("TextBox")
local UniSearchButton = Instance.new("ImageButton")
local UniScriptsList = Instance.new("ScrollingFrame")
local UniListLayout = Instance.new("UIListLayout")
local SettingsFrame = Instance.new("Frame")
local FilesFrame = Instance.new("Frame")
local FilesHeader = Instance.new("Frame")
local FilesIcon = Instance.new("ImageLabel")
local FilesLabel = Instance.new("TextLabel")
local FilesList = Instance.new("ScrollingFrame")
local FilesListLayout = Instance.new("UIListLayout")
local FileNameBox = Instance.new("TextBox")
local SaveFileBtn = Instance.new("ImageButton")
local LoadFileBtn = Instance.new("ImageButton")
local RenameFileBtn = Instance.new("ImageButton")
local DeleteFileBtn = Instance.new("ImageButton")
local ExecuteFileBtn = Instance.new("ImageButton")
local CloseKeybind = Instance.new("TextLabel")
local TextLabel = Instance.new("TextLabel")

Windows11UI.Name = "Windows11UI"
Windows11UI.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
Windows11UI.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

Topbar.Name = "Topbar"
Topbar.Parent = Windows11UI
Topbar.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
Topbar.BorderSizePixel = 0
Topbar.Position = UDim2.new(0.279261738, 0, 0.19421488, 0)
Topbar.Size = UDim2.new(0, 700, 0, 56)

UICorner.Parent = Topbar

-- ADDED: UI Gradient for Topbar
local TopbarGradient = Instance.new("UIGradient")
TopbarGradient.Parent = Topbar
TopbarGradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 30, 30)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(20, 20, 20)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(40, 40, 40))
})
TopbarGradient.Rotation = 45

Frame.Parent = Topbar
Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Frame.BorderSizePixel = 0
Frame.Position = UDim2.new(0, 0, 0.65956223, 0)
Frame.Size = UDim2.new(0, 700, 0, 320)

UICorner_2.Parent = Frame

-- ADDED: UI Gradient for Main Frame
local FrameGradient = Instance.new("UIGradient")
FrameGradient.Parent = Frame
FrameGradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(35, 35, 35)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(30, 30, 30)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(25, 25, 25))
})
FrameGradient.Rotation = 90

-- MODIFIED: Files Frame with darker blend
FilesFrame.Name = "FilesFrame"
FilesFrame.Parent = Frame
FilesFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
FilesFrame.BorderSizePixel = 0
FilesFrame.Position = UDim2.new(0, 0, 0, 0)
FilesFrame.Size = UDim2.new(0, 140, 0, 320)

local FilesCorner = Instance.new("UICorner")
FilesCorner.CornerRadius = UDim.new(0, 0)
FilesCorner.Parent = FilesFrame

FilesHeader.Name = "FilesHeader"
FilesHeader.Parent = FilesFrame
FilesHeader.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
FilesHeader.BorderSizePixel = 0
FilesHeader.Position = UDim2.new(0, 0, 0, 0)
FilesHeader.Size = UDim2.new(1, 0, 0, 40)

local HeaderCorner = Instance.new("UICorner")
HeaderCorner.CornerRadius = UDim.new(0, 0)
HeaderCorner.Parent = FilesHeader

FilesIcon.Name = "FilesIcon"
FilesIcon.Parent = FilesHeader
FilesIcon.BackgroundTransparency = 1
FilesIcon.Position = UDim2.new(0, 10, 0, 5)
FilesIcon.Size = UDim2.new(0, 30, 0, 30)
FilesIcon.Image = "rbxassetid://76766188301720"

FilesLabel.Name = "FilesLabel"
FilesLabel.Parent = FilesHeader
FilesLabel.BackgroundTransparency = 1
FilesLabel.Position = UDim2.new(0, 45, 0, 0)
FilesLabel.Size = UDim2.new(0, 95, 0, 40)
FilesLabel.Font = Enum.Font.GothamBold
FilesLabel.Text = "FILES"
FilesLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
FilesLabel.TextSize = 16

FilesList.Name = "FilesList"
FilesList.Parent = FilesFrame
FilesList.BackgroundTransparency = 1
FilesList.Position = UDim2.new(0, 5, 0, 85)
FilesList.Size = UDim2.new(0, 130, 0, 140)
FilesList.ScrollBarThickness = 3
FilesList.CanvasSize = UDim2.new(0, 0, 0, 0)

FilesListLayout.Parent = FilesList
FilesListLayout.SortOrder = Enum.SortOrder.LayoutOrder
FilesListLayout.Padding = UDim.new(0, 4)

FileNameBox.Name = "FileNameBox"
FileNameBox.Parent = FilesFrame
FileNameBox.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
FileNameBox.BorderColor3 = Color3.fromRGB(40, 40, 40)
FileNameBox.BorderSizePixel = 1
FileNameBox.Position = UDim2.new(0, 5, 0, 45)
FileNameBox.Size = UDim2.new(0, 130, 0, 25)
FileNameBox.Font = Enum.Font.Gotham
FileNameBox.Text = ""
FileNameBox.PlaceholderText = "File name..."
FileNameBox.PlaceholderColor3 = Color3.fromRGB(80, 80, 80)
FileNameBox.TextColor3 = Color3.fromRGB(255, 255, 255)
FileNameBox.TextSize = 11
FileNameBox.TextXAlignment = Enum.TextXAlignment.Left

Instance.new("UICorner", FileNameBox).CornerRadius = UDim.new(0, 4)

-- MODIFIED: File buttons with darker colors
SaveFileBtn.Name = "SaveFileBtn"
SaveFileBtn.Parent = FilesFrame
SaveFileBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
SaveFileBtn.Position = UDim2.new(0, 5, 0, 230)
SaveFileBtn.Size = UDim2.new(0, 35, 0, 35)
SaveFileBtn.Image = "rbxassetid://11768914234"

Instance.new("UICorner", SaveFileBtn).CornerRadius = UDim.new(0, 6)

-- ENHANCED: PC-style tooltip for Save
local SaveTooltip = Instance.new("Frame")
SaveTooltip.Name = "SaveTooltip"
SaveTooltip.Parent = SaveFileBtn
SaveTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
SaveTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
SaveTooltip.BorderSizePixel = 1
SaveTooltip.Position = UDim2.new(0, 0, 0, -28)
SaveTooltip.Size = UDim2.new(0, 60, 0, 22)
SaveTooltip.Visible = false
SaveTooltip.ZIndex = 10

local SaveTooltipCorner = Instance.new("UICorner")
SaveTooltipCorner.CornerRadius = UDim.new(0, 4)
SaveTooltipCorner.Parent = SaveTooltip

local SaveTooltipText = Instance.new("TextLabel")
SaveTooltipText.Parent = SaveTooltip
SaveTooltipText.BackgroundTransparency = 1
SaveTooltipText.Size = UDim2.new(1, 0, 1, 0)
SaveTooltipText.Font = Enum.Font.GothamSemibold
SaveTooltipText.Text = "Save"
SaveTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
SaveTooltipText.TextSize = 11
SaveTooltipText.ZIndex = 11

SaveFileBtn.MouseEnter:Connect(function() SaveTooltip.Visible = true end)
SaveFileBtn.MouseLeave:Connect(function() SaveTooltip.Visible = false end)

LoadFileBtn.Name = "LoadFileBtn"
LoadFileBtn.Parent = FilesFrame
LoadFileBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
LoadFileBtn.Position = UDim2.new(0, 45, 0, 230)
LoadFileBtn.Size = UDim2.new(0, 35, 0, 35)
LoadFileBtn.Image = "rbxassetid://85502241059648"

Instance.new("UICorner", LoadFileBtn).CornerRadius = UDim.new(0, 6)

-- ENHANCED: PC-style tooltip for Load
local LoadTooltip = Instance.new("Frame")
LoadTooltip.Name = "LoadTooltip"
LoadTooltip.Parent = LoadFileBtn
LoadTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
LoadTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
LoadTooltip.BorderSizePixel = 1
LoadTooltip.Position = UDim2.new(0, 0, 0, -28)
LoadTooltip.Size = UDim2.new(0, 60, 0, 22)
LoadTooltip.Visible = false
LoadTooltip.ZIndex = 10

local LoadTooltipCorner = Instance.new("UICorner")
LoadTooltipCorner.CornerRadius = UDim.new(0, 4)
LoadTooltipCorner.Parent = LoadTooltip

local LoadTooltipText = Instance.new("TextLabel")
LoadTooltipText.Parent = LoadTooltip
LoadTooltipText.BackgroundTransparency = 1
LoadTooltipText.Size = UDim2.new(1, 0, 1, 0)
LoadTooltipText.Font = Enum.Font.GothamSemibold
LoadTooltipText.Text = "Load"
LoadTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
LoadTooltipText.TextSize = 11
LoadTooltipText.ZIndex = 11

LoadFileBtn.MouseEnter:Connect(function() LoadTooltip.Visible = true end)
LoadFileBtn.MouseLeave:Connect(function() LoadTooltip.Visible = false end)

RenameFileBtn.Name = "RenameFileBtn"
RenameFileBtn.Parent = FilesFrame
RenameFileBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
RenameFileBtn.Position = UDim2.new(0, 85, 0, 230)
RenameFileBtn.Size = UDim2.new(0, 35, 0, 35)
RenameFileBtn.Image = "rbxassetid://88134306391339"

Instance.new("UICorner", RenameFileBtn).CornerRadius = UDim.new(0, 6)

-- ENHANCED: PC-style tooltip for Rename
local RenameTooltip = Instance.new("Frame")
RenameTooltip.Name = "RenameTooltip"
RenameTooltip.Parent = RenameFileBtn
RenameTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
RenameTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
RenameTooltip.BorderSizePixel = 1
RenameTooltip.Position = UDim2.new(0, 0, 0, -28)
RenameTooltip.Size = UDim2.new(0, 60, 0, 22)
RenameTooltip.Visible = false
RenameTooltip.ZIndex = 10

local RenameTooltipCorner = Instance.new("UICorner")
RenameTooltipCorner.CornerRadius = UDim.new(0, 4)
RenameTooltipCorner.Parent = RenameTooltip

local RenameTooltipText = Instance.new("TextLabel")
RenameTooltipText.Parent = RenameTooltip
RenameTooltipText.BackgroundTransparency = 1
RenameTooltipText.Size = UDim2.new(1, 0, 1, 0)
RenameTooltipText.Font = Enum.Font.GothamSemibold
RenameTooltipText.Text = "Rename"
RenameTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
RenameTooltipText.TextSize = 11
RenameTooltipText.ZIndex = 11

RenameFileBtn.MouseEnter:Connect(function() RenameTooltip.Visible = true end)
RenameFileBtn.MouseLeave:Connect(function() RenameTooltip.Visible = false end)

DeleteFileBtn.Name = "DeleteFileBtn"
DeleteFileBtn.Parent = FilesFrame
DeleteFileBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
DeleteFileBtn.Position = UDim2.new(0, 5, 0, 275)
DeleteFileBtn.Size = UDim2.new(0, 35, 0, 35)
DeleteFileBtn.Image = "rbxassetid://76624782632416"

Instance.new("UICorner", DeleteFileBtn).CornerRadius = UDim.new(0, 6)

-- ENHANCED: PC-style tooltip for Delete
local DeleteTooltip = Instance.new("Frame")
DeleteTooltip.Name = "DeleteTooltip"
DeleteTooltip.Parent = DeleteFileBtn
DeleteTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
DeleteTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
DeleteTooltip.BorderSizePixel = 1
DeleteTooltip.Position = UDim2.new(0, 0, 0, -28)
DeleteTooltip.Size = UDim2.new(0, 60, 0, 22)
DeleteTooltip.Visible = false
DeleteTooltip.ZIndex = 10

local DeleteTooltipCorner = Instance.new("UICorner")
DeleteTooltipCorner.CornerRadius = UDim.new(0, 4)
DeleteTooltipCorner.Parent = DeleteTooltip

local DeleteTooltipText = Instance.new("TextLabel")
DeleteTooltipText.Parent = DeleteTooltip
DeleteTooltipText.BackgroundTransparency = 1
DeleteTooltipText.Size = UDim2.new(1, 0, 1, 0)
DeleteTooltipText.Font = Enum.Font.GothamSemibold
DeleteTooltipText.Text = "Delete"
DeleteTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
DeleteTooltipText.TextSize = 11
DeleteTooltipText.ZIndex = 11

DeleteFileBtn.MouseEnter:Connect(function() DeleteTooltip.Visible = true end)
DeleteFileBtn.MouseLeave:Connect(function() DeleteTooltip.Visible = false end)

ExecuteFileBtn.Name = "ExecuteFileBtn"
ExecuteFileBtn.Parent = FilesFrame
ExecuteFileBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
ExecuteFileBtn.Position = UDim2.new(0, 45, 0, 275)
ExecuteFileBtn.Size = UDim2.new(0, 35, 0, 35)
ExecuteFileBtn.Image = "rbxassetid://119065240115720"

Instance.new("UICorner", ExecuteFileBtn).CornerRadius = UDim.new(0, 6)

-- ENHANCED: PC-style tooltip for Execute
local ExecTooltip = Instance.new("Frame")
ExecTooltip.Name = "ExecTooltip"
ExecTooltip.Parent = ExecuteFileBtn
ExecTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
ExecTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
ExecTooltip.BorderSizePixel = 1
ExecTooltip.Position = UDim2.new(0, 0, 0, -28)
ExecTooltip.Size = UDim2.new(0, 60, 0, 22)
ExecTooltip.Visible = false
ExecTooltip.ZIndex = 10

local ExecTooltipCorner = Instance.new("UICorner")
ExecTooltipCorner.CornerRadius = UDim.new(0, 4)
ExecTooltipCorner.Parent = ExecTooltip

local ExecTooltipText = Instance.new("TextLabel")
ExecTooltipText.Parent = ExecTooltip
ExecTooltipText.BackgroundTransparency = 1
ExecTooltipText.Size = UDim2.new(1, 0, 1, 0)
ExecTooltipText.Font = Enum.Font.GothamSemibold
ExecTooltipText.Text = "Execute"
ExecTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
ExecTooltipText.TextSize = 11
ExecTooltipText.ZIndex = 11

ExecuteFileBtn.MouseEnter:Connect(function() ExecTooltip.Visible = true end)
ExecuteFileBtn.MouseLeave:Connect(function() ExecTooltip.Visible = false end)

TabFrame.Name = "TabFrame"
TabFrame.Parent = Frame
TabFrame.BackgroundTransparency = 1
TabFrame.BorderSizePixel = 0
TabFrame.Position = UDim2.new(0, 150, 0, 5)
TabFrame.Size = UDim2.new(0, 545, 0, 30)

InfoTab.Name = "InfoTab"
InfoTab.Parent = TabFrame
InfoTab.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
InfoTab.BorderSizePixel = 0
InfoTab.Position = UDim2.new(0, 0, 0, 0)
InfoTab.Size = UDim2.new(0, 35, 0, 30)
InfoTab.Image = "rbxassetid://110502792434357"
InfoTab.ImageColor3 = Color3.fromRGB(200, 200, 200)

Instance.new("UICorner", InfoTab).CornerRadius = UDim.new(0, 6)

EditorTab.Name = "EditorTab"
EditorTab.Parent = TabFrame
EditorTab.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
EditorTab.BorderSizePixel = 0
EditorTab.Position = UDim2.new(0, 45, 0, 0)
EditorTab.Size = UDim2.new(0, 35, 0, 30)
EditorTab.Image = "rbxassetid://117772889196810"

Instance.new("UICorner", EditorTab).CornerRadius = UDim.new(0, 6)

SearcherTab.Name = "SearcherTab"
SearcherTab.Parent = TabFrame
SearcherTab.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
SearcherTab.BorderSizePixel = 0
SearcherTab.Position = UDim2.new(0, 90, 0, 0)
SearcherTab.Size = UDim2.new(0, 35, 0, 30)
SearcherTab.Image = "rbxassetid://88898640085751"
SearcherTab.ImageColor3 = Color3.fromRGB(200, 200, 200)

Instance.new("UICorner", SearcherTab).CornerRadius = UDim.new(0, 6)

GameScriptsTab.Name = "GameScriptsTab"
GameScriptsTab.Parent = TabFrame
GameScriptsTab.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
GameScriptsTab.BorderSizePixel = 0
GameScriptsTab.Position = UDim2.new(0, 135, 0, 0)
GameScriptsTab.Size = UDim2.new(0, 35, 0, 30)
GameScriptsTab.Image = "rbxassetid://86591853167234"
GameScriptsTab.ImageColor3 = Color3.fromRGB(200, 200, 200)

Instance.new("UICorner", GameScriptsTab).CornerRadius = UDim.new(0, 6)

UniversalScriptsTab.Name = "UniversalScriptsTab"
UniversalScriptsTab.Parent = TabFrame
UniversalScriptsTab.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
UniversalScriptsTab.BorderSizePixel = 0
UniversalScriptsTab.Position = UDim2.new(0, 180, 0, 0)
UniversalScriptsTab.Size = UDim2.new(0, 35, 0, 30)
UniversalScriptsTab.Image = "rbxassetid://134398528532961"
UniversalScriptsTab.ImageColor3 = Color3.fromRGB(200, 200, 200)

Instance.new("UICorner", UniversalScriptsTab).CornerRadius = UDim.new(0, 6)

SettingsTab.Name = "SettingsTab"
SettingsTab.Parent = TabFrame
SettingsTab.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
SettingsTab.BorderSizePixel = 0
SettingsTab.Position = UDim2.new(0, 225, 0, 0)
SettingsTab.Size = UDim2.new(0, 35, 0, 30)
SettingsTab.Image = "rbxassetid://115847366049931"
SettingsTab.ImageColor3 = Color3.fromRGB(200, 200, 200)

Instance.new("UICorner", SettingsTab).CornerRadius = UDim.new(0, 6)

InfoFrame.Name = "InfoFrame"
InfoFrame.Parent = Frame
InfoFrame.BackgroundTransparency = 1
InfoFrame.Position = UDim2.new(0, 150, 0, 40)
InfoFrame.Size = UDim2.new(0, 545, 0, 275)
InfoFrame.Visible = false

InfoBackground.Name = "InfoBackground"
InfoBackground.Parent = InfoFrame
InfoBackground.BackgroundTransparency = 1
InfoBackground.Size = UDim2.new(1, 0, 1, 0)
InfoBackground.Image = "rbxassetid://6655732452"
InfoBackground.ImageTransparency = 0.3
InfoBackground.ScaleType = Enum.ScaleType.Crop

Instance.new("UICorner", InfoBackground).CornerRadius = UDim.new(0, 6)

-- COMPACT INFO LAYOUT - 2x2 Grid with Images
local InfoContainer = Instance.new("Frame")
InfoContainer.Name = "InfoContainer"
InfoContainer.Parent = InfoFrame
InfoContainer.BackgroundTransparency = 1
InfoContainer.Position = UDim2.new(0, 10, 0, 10)
InfoContainer.Size = UDim2.new(1, -20, 1, -20)

local function CreateCompactInfoWithImage(title, value, posX, posY, sizeX, sizeY, imageId)
    local section = Instance.new("Frame")
    section.Name = title .. "Section"
    section.Parent = InfoContainer
    section.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    section.Position = UDim2.new(posX, 0, posY, 0)
    section.Size = UDim2.new(sizeX, 0, sizeY, 0)
    Instance.new("UICorner", section).CornerRadius = UDim.new(0, 6)
    
    local icon = Instance.new("ImageLabel")
    icon.Name = "Icon"
    icon.Parent = section
    icon.BackgroundTransparency = 1
    icon.Position = UDim2.new(0, 8, 0, 8)
    icon.Size = UDim2.new(0, 20, 0, 20)
    icon.Image = "rbxassetid://" .. imageId
    icon.ImageColor3 = Color3.fromRGB(200, 200, 200)
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "Title"
    titleLabel.Parent = section
    titleLabel.BackgroundTransparency = 1
    titleLabel.Position = UDim2.new(0, 35, 0, 4)
    titleLabel.Size = UDim2.new(1, -45, 0, 16)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.Text = title
    titleLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
    titleLabel.TextSize = 11
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    
    local valueLabel = Instance.new("TextLabel")
    valueLabel.Name = "Value"
    valueLabel.Parent = section
    valueLabel.BackgroundTransparency = 1
    valueLabel.Position = UDim2.new(0, 8, 0, 28)
    valueLabel.Size = UDim2.new(1, -16, 1, -36)
    valueLabel.Font = Enum.Font.Gotham
    valueLabel.Text = value
    valueLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    valueLabel.TextSize = 11
    valueLabel.TextXAlignment = Enum.TextXAlignment.Left
    valueLabel.TextYAlignment = Enum.TextYAlignment.Top
    valueLabel.TextWrapped = true
    
    return valueLabel
end

local player = game.Players.LocalPlayer
local gameInfo = game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId)

-- Top Row - Server & User (Side by Side)
local serverId = game.JobId ~= "" and game.JobId:sub(1, 6) .. "..." or "Private"
local serverText = "ID: " .. serverId .. "\nPlayers: " .. #game.Players:GetPlayers() .. "/" .. game.Players.MaxPlayers
local serverLabel = CreateCompactInfoWithImage("Server Info", serverText, 0, 0, 0.48, 0.20, "18189876016")

local userText = "Name: " .. player.Name .. "\nDisplay: " .. player.DisplayName .. "\nID: " .. player.UserId
local userLabel = CreateCompactInfoWithImage("User Info", userText, 0.52, 0, 0.48, 0.20, "15164135517")

-- Middle Row - Game & Time (Side by Side)
local gameText = gameInfo.Name:sub(1, 25) .. (gameInfo.Name:len() > 25 and "..." or "") .. "\nPlace ID: " .. game.PlaceId
local gameLabel = CreateCompactInfoWithImage("Game", gameText, 0, 0.23, 0.48, 0.20, "92416323895079")

local timeLabel = CreateCompactInfoWithImage("Time Zone", "Loading...", 0.52, 0.23, 0.48, 0.20, "100658411712215")

-- ADDED: System Stats Row (FPS, Ping, Memory, CPU, GPU)
local function CreateSystemStat(name, posX, imageId)
    local section = Instance.new("Frame")
    section.Name = name .. "Stat"
    section.Parent = InfoContainer
    section.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    section.Position = UDim2.new(posX, 0, 0.46, 0)
    section.Size = UDim2.new(0.18, -4, 0.14, 0)
    Instance.new("UICorner", section).CornerRadius = UDim.new(0, 6)
    
    local icon = Instance.new("ImageLabel")
    icon.Name = "Icon"
    icon.Parent = section
    icon.BackgroundTransparency = 1
    icon.Position = UDim2.new(0, 5, 0, 5)
    icon.Size = UDim2.new(0, 16, 0, 16)
    icon.Image = "rbxassetid://" .. imageId
    icon.ImageColor3 = Color3.fromRGB(200, 200, 200)
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "Title"
    titleLabel.Parent = section
    titleLabel.BackgroundTransparency = 1
    titleLabel.Position = UDim2.new(0, 26, 0, 2)
    titleLabel.Size = UDim2.new(1, -30, 0, 14)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.Text = name
    titleLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
    titleLabel.TextSize = 9
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    
    local valueLabel = Instance.new("TextLabel")
    valueLabel.Name = "Value"
    valueLabel.Parent = section
    valueLabel.BackgroundTransparency = 1
    valueLabel.Position = UDim2.new(0, 5, 0, 18)
    valueLabel.Size = UDim2.new(1, -10, 0, 16)
    valueLabel.Font = Enum.Font.Gotham
    valueLabel.Text = "0"
    valueLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    valueLabel.TextSize = 11
    valueLabel.TextXAlignment = Enum.TextXAlignment.Center
    
    return valueLabel
end

-- Create system stat boxes
local fpsLabel = CreateSystemStat("FPS", 0, "80514302796622")
local pingLabel = CreateSystemStat("Ping", 0.20, "73804197684672")
local memoryLabel = CreateSystemStat("Memory", 0.40, "6934996829")
local cpuLabel = CreateSystemStat("CPU", 0.60, "83732980750188")
local gpuLabel = CreateSystemStat("GPU", 0.80, "120144751660153")

-- Auto Update Stats every 0 seconds (every frame)
local RunService = game:GetService("RunService")
local Stats = game:GetService("Stats")

local function updateStats()
    -- Update Server Info
    local currentServerId = game.JobId ~= "" and game.JobId:sub(1, 6) .. "..." or "Private"
    serverLabel.Text = "ID: " .. currentServerId .. "\nPlayers: " .. #game.Players:GetPlayers() .. "/" .. game.Players.MaxPlayers
    
    -- Update User Info
    userLabel.Text = "Name: " .. player.Name .. "\nDisplay: " .. player.DisplayName .. "\nID: " .. player.UserId
    
    -- Update Game Info
    local success, currentGameInfo = pcall(function()
        return game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId)
    end)
    if success then
        local currentGameText = currentGameInfo.Name:sub(1, 25) .. (currentGameInfo.Name:len() > 25 and "..." or "") .. "\nPlace ID: " .. game.PlaceId
        gameLabel.Text = currentGameText
    end
    
    -- Update Time
    local timeZone = os.date("%Z") or "Unknown"
    local localTime = os.date("%I:%M:%S %p")
    timeLabel.Text = "Zone: " .. timeZone .. "\nTime: " .. localTime
    
    -- ADDED: Update System Stats
    -- FPS
    fpsLabel.Text = tostring(math.floor(Stats.Workspace.Heartbeat:GetValue()))
    
    -- Ping
    pingLabel.Text = tostring(math.floor(Stats.Network.ServerStatsItem["Data Ping"]:GetValue())) .. " ms"
    
    -- Memory (in MB)
    memoryLabel.Text = tostring(math.floor(Stats:GetTotalMemoryUsageMb())) .. " MB"
    
    -- CPU (approximation using heartbeat time)
    local cpuUsage = math.floor((Stats.Workspace.Heartbeat:GetValue() / 60) * 100)
    cpuLabel.Text = tostring(cpuUsage) .. "%"
    
    -- GPU (Roblox doesn't expose direct GPU usage, using render time as approximation)
    local gpuTime = Stats.Workspace.Heartbeat:GetValue()
    gpuLabel.Text = tostring(math.floor(gpuTime)) .. " ms"
end

-- Run update immediately and connect to Heartbeat for 0s updates
updateStats()
RunService.Heartbeat:Connect(updateStats)

-- Bottom - Discord (Full Width, Compact) with Thumbnail
local DiscordSection = Instance.new("Frame")
DiscordSection.Name = "DiscordSection"
DiscordSection.Parent = InfoContainer
DiscordSection.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
DiscordSection.Position = UDim2.new(0, 0, 0.62, 0)
DiscordSection.Size = UDim2.new(1, 0, 0.34, 0)
Instance.new("UICorner", DiscordSection).CornerRadius = UDim.new(0, 6)

-- Discord Thumbnail (Left side)
local DiscordThumbnail = Instance.new("ImageLabel")
DiscordThumbnail.Name = "DiscordThumbnail"
DiscordThumbnail.Parent = DiscordSection
DiscordThumbnail.BackgroundTransparency = 1
DiscordThumbnail.Position = UDim2.new(0, 10, 0.5, -25)
DiscordThumbnail.Size = UDim2.new(0, 50, 0, 50)
DiscordThumbnail.Image = "rbxassetid://114216963895291"
DiscordThumbnail.ScaleType = Enum.ScaleType.Crop
Instance.new("UICorner", DiscordThumbnail).CornerRadius = UDim.new(0, 6)

DiscordIcon.Name = "DiscordIcon"
DiscordIcon.Parent = DiscordSection
DiscordIcon.BackgroundTransparency = 1
DiscordIcon.Position = UDim2.new(0, 70, 0.5, -15)
DiscordIcon.Size = UDim2.new(0, 30, 0, 30)
DiscordIcon.Image = "rbxassetid://115249452401470"

DiscordLabel.Name = "DiscordLabel"
DiscordLabel.Parent = DiscordSection
DiscordLabel.BackgroundTransparency = 1
DiscordLabel.Position = UDim2.new(0, 105, 0, 8)
DiscordLabel.Size = UDim2.new(1, -260, 0, 20)
DiscordLabel.Font = Enum.Font.GothamBold
DiscordLabel.Text = "Join our Discord Server"
DiscordLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
DiscordLabel.TextSize = 13
DiscordLabel.TextXAlignment = Enum.TextXAlignment.Left

local DiscordLink = Instance.new("TextLabel")
DiscordLink.Name = "DiscordLink"
DiscordLink.Parent = DiscordSection
DiscordLink.BackgroundTransparency = 1
DiscordLink.Position = UDim2.new(0, 105, 0, 26)
DiscordLink.Size = UDim2.new(1, -260, 0, 16)
DiscordLink.Font = Enum.Font.Gotham
DiscordLink.Text = "discord.gg/xnVDpcAYgC"
DiscordLink.TextColor3 = Color3.fromRGB(180, 180, 180)
DiscordLink.TextSize = 11
DiscordLink.TextXAlignment = Enum.TextXAlignment.Left

-- Compact Copy Button
CopyDiscordBtn.Name = "CopyDiscordBtn"
CopyDiscordBtn.Parent = DiscordSection
CopyDiscordBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
CopyDiscordBtn.Position = UDim2.new(1, -110, 0.5, -15)
CopyDiscordBtn.Size = UDim2.new(0, 100, 0, 30)
CopyDiscordBtn.Image = "rbxassetid://16264282445"
CopyDiscordBtn.ImageColor3 = Color3.fromRGB(255, 255, 255)

Instance.new("UICorner", CopyDiscordBtn).CornerRadius = UDim.new(0, 6)

CopyDiscordLabel.Name = "CopyDiscordLabel"
CopyDiscordLabel.Parent = CopyDiscordBtn
CopyDiscordLabel.BackgroundTransparency = 1
CopyDiscordLabel.Size = UDim2.new(1, 0, 1, 0)
CopyDiscordLabel.Font = Enum.Font.Gotham
CopyDiscordLabel.Text = "Copy"
CopyDiscordLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
CopyDiscordLabel.TextSize = 11

EditorFrame.Name = "EditorFrame"
EditorFrame.Parent = Frame
EditorFrame.BackgroundTransparency = 1
EditorFrame.Position = UDim2.new(0, 150, 0, 40)
EditorFrame.Size = UDim2.new(0, 545, 0, 275)

-- FIXED: Line Numbers ScrollFrame
local LineNumberFrame = Instance.new("ScrollingFrame")
LineNumberFrame.Name = "LineNumberFrame"
LineNumberFrame.Parent = EditorFrame
LineNumberFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
LineNumberFrame.BorderSizePixel = 0
LineNumberFrame.Position = UDim2.new(0, 0, 0, 0)
LineNumberFrame.Size = UDim2.new(0, 35, 0, 225)
LineNumberFrame.ScrollBarThickness = 0
LineNumberFrame.CanvasSize = UDim2.new(0, 0, 0, 450)
LineNumberFrame.ScrollingDirection = Enum.ScrollingDirection.Y
LineNumberFrame.ScrollingEnabled = false

Instance.new("UICorner", LineNumberFrame).CornerRadius = UDim.new(0, 6)

local LineNumbers = Instance.new("TextLabel")
LineNumbers.Name = "LineNumbers"
LineNumbers.Parent = LineNumberFrame
LineNumbers.BackgroundTransparency = 1
LineNumbers.Size = UDim2.new(1, -5, 0, 900)
LineNumbers.Position = UDim2.new(0, 0, 0, 0)
LineNumbers.Font = Enum.Font.Code
LineNumbers.Text = "1"
LineNumbers.TextColor3 = Color3.fromRGB(100, 100, 100)
LineNumbers.TextSize = 14
LineNumbers.TextYAlignment = Enum.TextYAlignment.Top
LineNumbers.TextXAlignment = Enum.TextXAlignment.Right

-- MODIFIED: Editor ScrollFrame with BOTH horizontal and vertical scrolling
local EditorScrollFrame = Instance.new("ScrollingFrame")
EditorScrollFrame.Name = "EditorScrollFrame"
EditorScrollFrame.Parent = EditorFrame
EditorScrollFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
EditorScrollFrame.BorderColor3 = Color3.fromRGB(50, 50, 50)
EditorScrollFrame.BorderSizePixel = 1
EditorScrollFrame.Position = UDim2.new(0, 40, 0, 0)
EditorScrollFrame.Size = UDim2.new(0, 505, 0, 225)
EditorScrollFrame.ScrollBarThickness = 4
EditorScrollFrame.CanvasSize = UDim2.new(0, 2000, 0, 450)
EditorScrollFrame.ScrollingDirection = Enum.ScrollingDirection.XY
EditorScrollFrame.AutomaticCanvasSize = Enum.AutomaticSize.XY

Instance.new("UICorner", EditorScrollFrame).CornerRadius = UDim.new(0, 6)

-- RichText Label for Syntax Highlighting (Visible)
local SyntaxLabel = Instance.new("TextLabel")
SyntaxLabel.Name = "SyntaxLabel"
SyntaxLabel.Parent = EditorScrollFrame
SyntaxLabel.BackgroundTransparency = 1
SyntaxLabel.Size = UDim2.new(0, 2000, 0, 900)
SyntaxLabel.Position = UDim2.new(0, 5, 0, 0)
SyntaxLabel.Font = Enum.Font.Code
SyntaxLabel.Text = ""
SyntaxLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
SyntaxLabel.TextSize = 14
SyntaxLabel.TextWrapped = false
SyntaxLabel.TextXAlignment = Enum.TextXAlignment.Left
SyntaxLabel.TextYAlignment = Enum.TextYAlignment.Top
SyntaxLabel.RichText = true
SyntaxLabel.ClipsDescendants = true
SyntaxLabel.AutomaticSize = Enum.AutomaticSize.X

-- Source TextBox (Invisible but functional for input)
Source.Name = "Source"
Source.Parent = EditorScrollFrame
Source.BackgroundTransparency = 1
Source.Size = UDim2.new(0, 2000, 0, 900)
Source.Position = UDim2.new(0, 5, 0, 0)
Source.Font = Enum.Font.Code
Source.Text = ""
Source.TextColor3 = Color3.fromRGB(255, 255, 255)
Source.PlaceholderText = "-- Enter script here..."
Source.PlaceholderColor3 = Color3.fromRGB(100, 100, 100)
Source.TextSize = 14
Source.TextWrapped = false
Source.TextXAlignment = Enum.TextXAlignment.Left
Source.TextYAlignment = Enum.TextYAlignment.Top
Source.ClearTextOnFocus = false
Source.MultiLine = true
Source.TextTransparency = 0.5
Source.AutomaticSize = Enum.AutomaticSize.X

-- FIXED: Proper line number generation and syncing with syntax highlighting
local function updateLineNumbers()
    local text = Source.Text
    if text == "" then text = " " end
    local lines = 1
    for _ in text:gmatch("\n") do
        lines = lines + 1
    end
    
    local lineText = ""
    for i = 1, lines do
        lineText = lineText .. i .. "\n"
    end
    
    LineNumbers.Text = lineText:sub(1, -2)
    
    local lineHeight = 20
    local totalHeight = math.max(lines * lineHeight, 450)
    
    LineNumbers.Size = UDim2.new(1, -5, 0, totalHeight)
    Source.Size = UDim2.new(0, 2000, 0, totalHeight)
    SyntaxLabel.Size = UDim2.new(0, 2000, 0, totalHeight)
    
    LineNumberFrame.CanvasSize = UDim2.new(0, 0, 0, totalHeight)
    EditorScrollFrame.CanvasSize = UDim2.new(0, 2000, 0, totalHeight)
    
    -- Update syntax highlighting if enabled
    if Settings.SyntaxHighlighting then
        local success, highlighted = pcall(function()
            return highlighter.run(Source.Text)
        end)
        if success then
            SyntaxLabel.Text = highlighted
        else
            SyntaxLabel.Text = Source.Text
        end
    else
        SyntaxLabel.Text = Source.Text
    end
end

Source:GetPropertyChangedSignal("Text"):Connect(updateLineNumbers)

-- Sync scrolling
EditorScrollFrame:GetPropertyChangedSignal("CanvasPosition"):Connect(function()
    LineNumberFrame.CanvasPosition = Vector2.new(0, EditorScrollFrame.CanvasPosition.Y)
end)

-- Initialize
updateLineNumbers()

Execute.Name = "Execute"
Execute.Parent = EditorFrame
Execute.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Execute.BorderSizePixel = 0
Execute.Position = UDim2.new(0, 0, 0, 235)
Execute.Size = UDim2.new(0, 40, 0, 35)
Execute.Image = "rbxassetid://119065240115720"

Instance.new("UICorner", Execute).CornerRadius = UDim.new(0, 6)

-- ENHANCED: PC-style tooltip for Execute
local ExecuteTooltip = Instance.new("Frame")
ExecuteTooltip.Name = "ExecuteTooltip"
ExecuteTooltip.Parent = Execute
ExecuteTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
ExecuteTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
ExecuteTooltip.BorderSizePixel = 1
ExecuteTooltip.Position = UDim2.new(0, 0, 0, -28)
ExecuteTooltip.Size = UDim2.new(0, 60, 0, 22)
ExecuteTooltip.Visible = false
ExecuteTooltip.ZIndex = 10

local ExecuteTooltipCorner = Instance.new("UICorner")
ExecuteTooltipCorner.CornerRadius = UDim.new(0, 4)
ExecuteTooltipCorner.Parent = ExecuteTooltip

local ExecuteTooltipText = Instance.new("TextLabel")
ExecuteTooltipText.Parent = ExecuteTooltip
ExecuteTooltipText.BackgroundTransparency = 1
ExecuteTooltipText.Size = UDim2.new(1, 0, 1, 0)
ExecuteTooltipText.Font = Enum.Font.GothamSemibold
ExecuteTooltipText.Text = "Execute"
ExecuteTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
ExecuteTooltipText.TextSize = 11
ExecuteTooltipText.ZIndex = 11

Execute.MouseEnter:Connect(function() ExecuteTooltip.Visible = true end)
Execute.MouseLeave:Connect(function() ExecuteTooltip.Visible = false end)

Clear.Name = "Clear"
Clear.Parent = EditorFrame
Clear.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Clear.BorderSizePixel = 0
Clear.Position = UDim2.new(0, 50, 0, 235)
Clear.Size = UDim2.new(0, 40, 0, 35)
Clear.Image = "rbxassetid://76624782632416"

Instance.new("UICorner", Clear).CornerRadius = UDim.new(0, 6)

-- ENHANCED: PC-style tooltip for Clear
local ClearTooltip = Instance.new("Frame")
ClearTooltip.Name = "ClearTooltip"
ClearTooltip.Parent = Clear
ClearTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
ClearTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
ClearTooltip.BorderSizePixel = 1
ClearTooltip.Position = UDim2.new(0, 0, 0, -28)
ClearTooltip.Size = UDim2.new(0, 60, 0, 22)
ClearTooltip.Visible = false
ClearTooltip.ZIndex = 10

local ClearTooltipCorner = Instance.new("UICorner")
ClearTooltipCorner.CornerRadius = UDim.new(0, 4)
ClearTooltipCorner.Parent = ClearTooltip

local ClearTooltipText = Instance.new("TextLabel")
ClearTooltipText.Parent = ClearTooltip
ClearTooltipText.BackgroundTransparency = 1
ClearTooltipText.Size = UDim2.new(1, 0, 1, 0)
ClearTooltipText.Font = Enum.Font.GothamSemibold
ClearTooltipText.Text = "Clear"
ClearTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
ClearTooltipText.TextSize = 11
ClearTooltipText.ZIndex = 11

Clear.MouseEnter:Connect(function() ClearTooltip.Visible = true end)
Clear.MouseLeave:Connect(function() ClearTooltip.Visible = false end)

Paste.Name = "Paste"
Paste.Parent = EditorFrame
Paste.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Paste.BorderSizePixel = 0
Paste.Position = UDim2.new(0, 100, 0, 235)
Paste.Size = UDim2.new(0, 40, 0, 35)
Paste.Image = "rbxassetid://89773130507890"

Instance.new("UICorner", Paste).CornerRadius = UDim.new(0, 6)

-- ENHANCED: PC-style tooltip for Paste
local PasteTooltip = Instance.new("Frame")
PasteTooltip.Name = "PasteTooltip"
PasteTooltip.Parent = Paste
PasteTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
PasteTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
PasteTooltip.BorderSizePixel = 1
PasteTooltip.Position = UDim2.new(0, 0, 0, -28)
PasteTooltip.Size = UDim2.new(0, 60, 0, 22)
PasteTooltip.Visible = false
PasteTooltip.ZIndex = 10

local PasteTooltipCorner = Instance.new("UICorner")
PasteTooltipCorner.CornerRadius = UDim.new(0, 4)
PasteTooltipCorner.Parent = PasteTooltip

local PasteTooltipText = Instance.new("TextLabel")
PasteTooltipText.Parent = PasteTooltip
PasteTooltipText.BackgroundTransparency = 1
PasteTooltipText.Size = UDim2.new(1, 0, 1, 0)
PasteTooltipText.Font = Enum.Font.GothamSemibold
PasteTooltipText.Text = "Paste"
PasteTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
PasteTooltipText.TextSize = 11
PasteTooltipText.ZIndex = 11

Paste.MouseEnter:Connect(function() PasteTooltip.Visible = true end)
Paste.MouseLeave:Connect(function() PasteTooltip.Visible = false end)

Copy.Name = "Copy"
Copy.Parent = EditorFrame
Copy.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Copy.BorderSizePixel = 0
Copy.Position = UDim2.new(0, 150, 0, 235)
Copy.Size = UDim2.new(0, 40, 0, 35)
Copy.Image = "rbxassetid://127935026620905"

Instance.new("UICorner", Copy).CornerRadius = UDim.new(0, 6)

-- ENHANCED: PC-style tooltip for Copy
local CopyTooltip = Instance.new("Frame")
CopyTooltip.Name = "CopyTooltip"
CopyTooltip.Parent = Copy
CopyTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
CopyTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
CopyTooltip.BorderSizePixel = 1
CopyTooltip.Position = UDim2.new(0, 0, 0, -28)
CopyTooltip.Size = UDim2.new(0, 60, 0, 22)
CopyTooltip.Visible = false
CopyTooltip.ZIndex = 10

local CopyTooltipCorner = Instance.new("UICorner")
CopyTooltipCorner.CornerRadius = UDim.new(0, 4)
CopyTooltipCorner.Parent = CopyTooltip

local CopyTooltipText = Instance.new("TextLabel")
CopyTooltipText.Parent = CopyTooltip
CopyTooltipText.BackgroundTransparency = 1
CopyTooltipText.Size = UDim2.new(1, 0, 1, 0)
CopyTooltipText.Font = Enum.Font.GothamSemibold
CopyTooltipText.Text = "Copy"
CopyTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
CopyTooltipText.TextSize = 11
CopyTooltipText.ZIndex = 11

Copy.MouseEnter:Connect(function() CopyTooltip.Visible = true end)
Copy.MouseLeave:Connect(function() CopyTooltip.Visible = false end)

OpenConsole.Name = "OpenConsole"
OpenConsole.Parent = EditorFrame
OpenConsole.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
OpenConsole.BorderSizePixel = 0
OpenConsole.Position = UDim2.new(0, 410, 0, 235)
OpenConsole.Size = UDim2.new(0, 40, 0, 35)
OpenConsole.Image = "rbxassetid://102551636383591"

Instance.new("UICorner", OpenConsole).CornerRadius = UDim.new(0, 6)

-- ENHANCED: PC-style tooltip for Console
local ConsoleTooltip = Instance.new("Frame")
ConsoleTooltip.Name = "ConsoleTooltip"
ConsoleTooltip.Parent = OpenConsole
ConsoleTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
ConsoleTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
ConsoleTooltip.BorderSizePixel = 1
ConsoleTooltip.Position = UDim2.new(0, 0, 0, -28)
ConsoleTooltip.Size = UDim2.new(0, 60, 0, 22)
ConsoleTooltip.Visible = false
ConsoleTooltip.ZIndex = 10

local ConsoleTooltipCorner = Instance.new("UICorner")
ConsoleTooltipCorner.CornerRadius = UDim.new(0, 4)
ConsoleTooltipCorner.Parent = ConsoleTooltip

local ConsoleTooltipText = Instance.new("TextLabel")
ConsoleTooltipText.Parent = ConsoleTooltip
ConsoleTooltipText.BackgroundTransparency = 1
ConsoleTooltipText.Size = UDim2.new(1, 0, 1, 0)
ConsoleTooltipText.Font = Enum.Font.GothamSemibold
ConsoleTooltipText.Text = "Console"
ConsoleTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
ConsoleTooltipText.TextSize = 11
ConsoleTooltipText.ZIndex = 11

OpenConsole.MouseEnter:Connect(function() ConsoleTooltip.Visible = true end)
OpenConsole.MouseLeave:Connect(function() ConsoleTooltip.Visible = false end)

Inject.Name = "Inject"
Inject.Parent = EditorFrame
Inject.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Inject.BorderSizePixel = 0
Inject.Position = UDim2.new(0, 460, 0, 235)
Inject.Size = UDim2.new(0, 40, 0, 35)
Inject.Image = "rbxassetid://105409383174185"

Instance.new("UICorner", Inject).CornerRadius = UDim.new(0, 6)

-- ENHANCED: PC-style tooltip for Inject
local InjectTooltip = Instance.new("Frame")
InjectTooltip.Name = "InjectTooltip"
InjectTooltip.Parent = Inject
InjectTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
InjectTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
InjectTooltip.BorderSizePixel = 1
InjectTooltip.Position = UDim2.new(0, 0, 0, -28)
InjectTooltip.Size = UDim2.new(0, 60, 0, 22)
InjectTooltip.Visible = false
InjectTooltip.ZIndex = 10

local InjectTooltipCorner = Instance.new("UICorner")
InjectTooltipCorner.CornerRadius = UDim.new(0, 4)
InjectTooltipCorner.Parent = InjectTooltip

local InjectTooltipText = Instance.new("TextLabel")
InjectTooltipText.Parent = InjectTooltip
InjectTooltipText.BackgroundTransparency = 1
InjectTooltipText.Size = UDim2.new(1, 0, 1, 0)
InjectTooltipText.Font = Enum.Font.GothamSemibold
InjectTooltipText.Text = "Inject"
InjectTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
InjectTooltipText.TextSize = 11
InjectTooltipText.ZIndex = 11

Inject.MouseEnter:Connect(function() InjectTooltip.Visible = true end)
Inject.MouseLeave:Connect(function() InjectTooltip.Visible = false end)

SearcherFrame.Name = "SearcherFrame"
SearcherFrame.Parent = Frame
SearcherFrame.BackgroundTransparency = 1
SearcherFrame.Position = UDim2.new(0, 150, 0, 40)
SearcherFrame.Size = UDim2.new(0, 545, 0, 275)
SearcherFrame.Visible = false

SearchBox.Name = "SearchBox"
SearchBox.Parent = SearcherFrame
SearchBox.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
SearchBox.BorderColor3 = Color3.fromRGB(50, 50, 50)
SearchBox.BorderSizePixel = 1
SearchBox.Position = UDim2.new(0, 0, 0, 0)
SearchBox.Size = UDim2.new(0, 350, 0, 30)
SearchBox.Font = Enum.Font.Code
SearchBox.Text = ""
SearchBox.PlaceholderText = "Search ScriptBlox..."
SearchBox.PlaceholderColor3 = Color3.fromRGB(100, 100, 100)
SearchBox.TextColor3 = Color3.fromRGB(255, 255, 255)
SearchBox.TextSize = 13
SearchBox.TextXAlignment = Enum.TextXAlignment.Left

Instance.new("UICorner", SearchBox).CornerRadius = UDim.new(0, 6)

SearchButton.Name = "SearchButton"
SearchButton.Parent = SearcherFrame
SearchButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
SearchButton.BorderSizePixel = 0
SearchButton.Position = UDim2.new(0, 360, 0, 0)
SearchButton.Size = UDim2.new(0, 35, 0, 30)
SearchButton.Image = "rbxassetid://118397071140701"

Instance.new("UICorner", SearchButton).CornerRadius = UDim.new(0, 6)

FilterFrame.Name = "FilterFrame"
FilterFrame.Parent = SearcherFrame
FilterFrame.BackgroundTransparency = 1
FilterFrame.Position = UDim2.new(0, 0, 0, 35)
FilterFrame.Size = UDim2.new(0, 545, 0, 25)

local function CreateFilterButton(name, position, apiParam, color)
	local btn = Instance.new("TextButton")
	btn.Name = name .. "Filter"
	btn.Parent = FilterFrame
	btn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	btn.BorderSizePixel = 0
	btn.Position = position
	btn.Size = UDim2.new(0, 75, 0, 22)
	btn.Font = Enum.Font.Gotham
	btn.Text = name
	btn.TextColor3 = Color3.fromRGB(200, 200, 200)
	btn.TextSize = 10
	btn.AutoButtonColor = true
	
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 4)
	
	btn.MouseButton1Click:Connect(function()
		for _, child in pairs(FilterFrame:GetChildren()) do
			if child:IsA("TextButton") then
				child.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
				child.TextColor3 = Color3.fromRGB(200, 200, 200)
			end
		end
		btn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		btn.TextColor3 = Color3.fromRGB(255, 255, 255)
		CurrentFilter = apiParam
		CurrentPage = 1
		PerformSearch()
	end)
	
	return btn
end

FreeFilter = CreateFilterButton("Free", UDim2.new(0, 0, 0, 0), "mode=free")
VerifiedFilter = CreateFilterButton("Verified", UDim2.new(0, 80, 0, 0), "filters=verified&legacy_filters=true")
TrendingFilter = CreateFilterButton("Trending", UDim2.new(0, 160, 0, 0), "trending")
MostViewedFilter = CreateFilterButton("Most Viewed", UDim2.new(0, 240, 0, 0), "sortBy=views&order=desc")
UnverifiedFilter = CreateFilterButton("Unverified", UDim2.new(0, 320, 0, 0), "verified=0")

PageFrame.Name = "PageFrame"
PageFrame.Parent = SearcherFrame
PageFrame.BackgroundTransparency = 1
PageFrame.Position = UDim2.new(0, 0, 0, 65)
PageFrame.Size = UDim2.new(0, 545, 0, 30)

PrevPageBtn.Name = "PrevPage"
PrevPageBtn.Parent = PageFrame
PrevPageBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
PrevPageBtn.BorderSizePixel = 0
PrevPageBtn.Position = UDim2.new(0, 0, 0, 0)
PrevPageBtn.Size = UDim2.new(0, 40, 0, 28)
PrevPageBtn.Image = "rbxassetid://137224201341259"
PrevPageBtn.ImageColor3 = Color3.fromRGB(255, 255, 255)

Instance.new("UICorner", PrevPageBtn).CornerRadius = UDim.new(0, 6)

PageLabel.Name = "PageLabel"
PageLabel.Parent = PageFrame
PageLabel.BackgroundTransparency = 1
PageLabel.Position = UDim2.new(0, 45, 0, 0)
PageLabel.Size = UDim2.new(0, 40, 0, 28)
PageLabel.Font = Enum.Font.GothamBold
PageLabel.Text = "1"
PageLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
PageLabel.TextSize = 14

NextPageBtn.Name = "NextPage"
NextPageBtn.Parent = PageFrame
NextPageBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
NextPageBtn.BorderSizePixel = 0
NextPageBtn.Position = UDim2.new(0, 90, 0, 0)
NextPageBtn.Size = UDim2.new(0, 40, 0, 28)
NextPageBtn.Image = "rbxassetid://117408302517589"
NextPageBtn.ImageColor3 = Color3.fromRGB(255, 255, 255)

Instance.new("UICorner", NextPageBtn).CornerRadius = UDim.new(0, 6)

ScriptList.Name = "ScriptList"
ScriptList.Parent = SearcherFrame
ScriptList.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
ScriptList.BorderColor3 = Color3.fromRGB(50, 50, 50)
ScriptList.BorderSizePixel = 1
ScriptList.Position = UDim2.new(0, 0, 0, 100)
ScriptList.Size = UDim2.new(0, 545, 0, 175)
ScriptList.ScrollBarThickness = 4
ScriptList.CanvasSize = UDim2.new(0, 0, 0, 0)

Instance.new("UICorner", ScriptList).CornerRadius = UDim.new(0, 6)

ListLayout.Parent = ScriptList
ListLayout.SortOrder = Enum.SortOrder.LayoutOrder
ListLayout.Padding = UDim.new(0, 6)

GameScriptsFrame.Name = "GameScriptsFrame"
GameScriptsFrame.Parent = Frame
GameScriptsFrame.BackgroundTransparency = 1
GameScriptsFrame.Position = UDim2.new(0, 150, 0, 40)
GameScriptsFrame.Size = UDim2.new(0, 545, 0, 275)
GameScriptsFrame.Visible = false

GameSearchBox.Name = "GameSearchBox"
GameSearchBox.Parent = GameScriptsFrame
GameSearchBox.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
GameSearchBox.BorderColor3 = Color3.fromRGB(50, 50, 50)
GameSearchBox.BorderSizePixel = 1
GameSearchBox.Position = UDim2.new(0, 0, 0, 0)
GameSearchBox.Size = UDim2.new(0, 500, 0, 30)
GameSearchBox.Font = Enum.Font.Code
GameSearchBox.Text = ""
GameSearchBox.PlaceholderText = "Search Game Scripts..."
GameSearchBox.PlaceholderColor3 = Color3.fromRGB(100, 100, 100)
GameSearchBox.TextColor3 = Color3.fromRGB(255, 255, 255)
GameSearchBox.TextSize = 13
GameSearchBox.TextXAlignment = Enum.TextXAlignment.Left

Instance.new("UICorner", GameSearchBox).CornerRadius = UDim.new(0, 6)

GameSearchButton.Name = "GameSearchButton"
GameSearchButton.Parent = GameScriptsFrame
GameSearchButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
GameSearchButton.BorderSizePixel = 0
GameSearchButton.Position = UDim2.new(0, 510, 0, 0)
GameSearchButton.Size = UDim2.new(0, 35, 0, 30)
GameSearchButton.Image = "rbxassetid://118397071140701"

Instance.new("UICorner", GameSearchButton).CornerRadius = UDim.new(0, 6)

GameScriptsList.Name = "GameScriptsList"
GameScriptsList.Parent = GameScriptsFrame
GameScriptsList.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
GameScriptsList.BorderColor3 = Color3.fromRGB(50, 50, 50)
GameScriptsList.BorderSizePixel = 1
GameScriptsList.Position = UDim2.new(0, 0, 0, 40)
GameScriptsList.Size = UDim2.new(0, 545, 0, 235)
GameScriptsList.ScrollBarThickness = 4
GameScriptsList.CanvasSize = UDim2.new(0, 0, 0, 0)

Instance.new("UICorner", GameScriptsList).CornerRadius = UDim.new(0, 6)

GameListLayout.Parent = GameScriptsList
GameListLayout.SortOrder = Enum.SortOrder.LayoutOrder
GameListLayout.Padding = UDim.new(0, 5)

UniversalScriptsFrame.Name = "UniversalScriptsFrame"
UniversalScriptsFrame.Parent = Frame
UniversalScriptsFrame.BackgroundTransparency = 1
UniversalScriptsFrame.Position = UDim2.new(0, 150, 0, 40)
UniversalScriptsFrame.Size = UDim2.new(0, 545, 0, 275)
UniversalScriptsFrame.Visible = false

UniSearchBox.Name = "UniSearchBox"
UniSearchBox.Parent = UniversalScriptsFrame
UniSearchBox.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
UniSearchBox.BorderColor3 = Color3.fromRGB(50, 50, 50)
UniSearchBox.BorderSizePixel = 1
UniSearchBox.Position = UDim2.new(0, 0, 0, 0)
UniSearchBox.Size = UDim2.new(0, 500, 0, 30)
UniSearchBox.Font = Enum.Font.Code
UniSearchBox.Text = ""
UniSearchBox.PlaceholderText = "Search Universal Scripts..."
UniSearchBox.PlaceholderColor3 = Color3.fromRGB(100, 100, 100)
UniSearchBox.TextColor3 = Color3.fromRGB(255, 255, 255)
UniSearchBox.TextSize = 13
UniSearchBox.TextXAlignment = Enum.TextXAlignment.Left

Instance.new("UICorner", UniSearchBox).CornerRadius = UDim.new(0, 6)

UniSearchButton.Name = "UniSearchButton"
UniSearchButton.Parent = UniversalScriptsFrame
UniSearchButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
UniSearchButton.BorderSizePixel = 0
UniSearchButton.Position = UDim2.new(0, 510, 0, 0)
UniSearchButton.Size = UDim2.new(0, 35, 0, 30)
UniSearchButton.Image = "rbxassetid://118397071140701"

Instance.new("UICorner", UniSearchButton).CornerRadius = UDim.new(0, 6)

UniScriptsList.Name = "UniScriptsList"
UniScriptsList.Parent = UniversalScriptsFrame
UniScriptsList.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
UniScriptsList.BorderColor3 = Color3.fromRGB(50, 50, 50)
UniScriptsList.BorderSizePixel = 1
UniScriptsList.Position = UDim2.new(0, 0, 0, 40)
UniScriptsList.Size = UDim2.new(0, 545, 0, 235)
UniScriptsList.ScrollBarThickness = 4
UniScriptsList.CanvasSize = UDim2.new(0, 0, 0, 0)

Instance.new("UICorner", UniScriptsList).CornerRadius = UDim.new(0, 6)

UniListLayout.Parent = UniScriptsList
UniListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UniListLayout.Padding = UDim.new(0, 5)

-- SETTINGS FRAME
SettingsFrame.Name = "SettingsFrame"
SettingsFrame.Parent = Frame
SettingsFrame.BackgroundTransparency = 1
SettingsFrame.Position = UDim2.new(0, 150, 0, 40)
SettingsFrame.Size = UDim2.new(0, 545, 0, 275)
SettingsFrame.Visible = false

local SettingsContainer = Instance.new("Frame")
SettingsContainer.Name = "SettingsContainer"
SettingsContainer.Parent = SettingsFrame
SettingsContainer.BackgroundTransparency = 1
SettingsContainer.Position = UDim2.new(0, 10, 0, 10)
SettingsContainer.Size = UDim2.new(1, -20, 1, -20)

-- Font Selection
local FontLabel = Instance.new("TextLabel")
FontLabel.Name = "FontLabel"
FontLabel.Parent = SettingsContainer
FontLabel.BackgroundTransparency = 1
FontLabel.Position = UDim2.new(0, 0, 0, 0)
FontLabel.Size = UDim2.new(1, 0, 0, 25)
FontLabel.Font = Enum.Font.GothamBold
FontLabel.Text = "Editor Font"
FontLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
FontLabel.TextSize = 14
FontLabel.TextXAlignment = Enum.TextXAlignment.Left

local FontDropdown = Instance.new("TextButton")
FontDropdown.Name = "FontDropdown"
FontDropdown.Parent = SettingsContainer
FontDropdown.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
FontDropdown.Position = UDim2.new(0, 0, 0, 30)
FontDropdown.Size = UDim2.new(0, 200, 0, 35)
FontDropdown.Font = Enum.Font.Gotham
FontDropdown.Text = "  " .. Settings.Font
FontDropdown.TextColor3 = Color3.fromRGB(255, 255, 255)
FontDropdown.TextSize = 13
FontDropdown.TextXAlignment = Enum.TextXAlignment.Left

Instance.new("UICorner", FontDropdown).CornerRadius = UDim.new(0, 6)

local FontArrow = Instance.new("ImageLabel")
FontArrow.Name = "Arrow"
FontArrow.Parent = FontDropdown
FontArrow.BackgroundTransparency = 1
FontArrow.Position = UDim2.new(1, -25, 0.5, -8)
FontArrow.Size = UDim2.new(0, 16, 0, 16)
FontArrow.Image = "rbxassetid://117408302517589"
FontArrow.ImageColor3 = Color3.fromRGB(200, 200, 200)
FontArrow.Rotation = 90

local FontOptionsFrame = Instance.new("Frame")
FontOptionsFrame.Name = "FontOptions"
FontOptionsFrame.Parent = FontDropdown
FontOptionsFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
FontOptionsFrame.BorderColor3 = Color3.fromRGB(50, 50, 50)
FontOptionsFrame.BorderSizePixel = 1
FontOptionsFrame.Position = UDim2.new(0, 0, 1, 5)
FontOptionsFrame.Size = UDim2.new(1, 0, 0, 140)
FontOptionsFrame.Visible = false
FontOptionsFrame.ZIndex = 100

Instance.new("UICorner", FontOptionsFrame).CornerRadius = UDim.new(0, 6)

local FontOptionsLayout = Instance.new("UIListLayout")
FontOptionsLayout.Parent = FontOptionsFrame
FontOptionsLayout.SortOrder = Enum.SortOrder.LayoutOrder

local function CreateFontOption(name)
	local btn = Instance.new("TextButton")
	btn.Name = name .. "Option"
	btn.Parent = FontOptionsFrame
	btn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	btn.Size = UDim2.new(1, 0, 0, 35)
	btn.Font = Enum.Font.Gotham
	btn.Text = "  " .. name
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.TextSize = 12
	btn.TextXAlignment = Enum.TextXAlignment.Left
	btn.ZIndex = 101
	
	btn.MouseButton1Click:Connect(function()
		Settings.Font = name
		FontDropdown.Text = "  " .. name
		Source.Font = FontOptions[name]
		LineNumbers.Font = FontOptions[name]
		SyntaxLabel.Font = FontOptions[name]
		FontOptionsFrame.Visible = false
		FontArrow.Rotation = 90
		ShowNotification("Settings", "Font changed to " .. name, "Success", 2)
	end)
	
	return btn
end

CreateFontOption("Original")
CreateFontOption("Legacy")
CreateFontOption("Code")
CreateFontOption("Arcade")

FontDropdown.MouseButton1Click:Connect(function()
	FontOptionsFrame.Visible = not FontOptionsFrame.Visible
	FontArrow.Rotation = FontOptionsFrame.Visible and -90 or 90
end)

-- Syntax Highlighting Toggle
local SyntaxLabel = Instance.new("TextLabel")
SyntaxLabel.Name = "SyntaxLabel"
SyntaxLabel.Parent = SettingsContainer
SyntaxLabel.BackgroundTransparency = 1
SyntaxLabel.Position = UDim2.new(0, 0, 0, 90)
SyntaxLabel.Size = UDim2.new(1, 0, 0, 25)
SyntaxLabel.Font = Enum.Font.GothamBold
SyntaxLabel.Text = "Syntax Highlighting"
SyntaxLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
SyntaxLabel.TextSize = 14
SyntaxLabel.TextXAlignment = Enum.TextXAlignment.Left

local SyntaxToggle = Instance.new("TextButton")
SyntaxToggle.Name = "SyntaxToggle"
SyntaxToggle.Parent = SettingsContainer
SyntaxToggle.BackgroundColor3 = Settings.SyntaxHighlighting and Color3.fromRGB(50, 200, 100) or Color3.fromRGB(200, 50, 50)
SyntaxToggle.Position = UDim2.new(0, 0, 0, 120)
SyntaxToggle.Size = UDim2.new(0, 60, 0, 30)
SyntaxToggle.Font = Enum.Font.GothamBold
SyntaxToggle.Text = Settings.SyntaxHighlighting and "ON" or "OFF"
SyntaxToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
SyntaxToggle.TextSize = 12

Instance.new("UICorner", SyntaxToggle).CornerRadius = UDim.new(0, 15)

SyntaxToggle.MouseButton1Click:Connect(function()
	Settings.SyntaxHighlighting = not Settings.SyntaxHighlighting
	SyntaxToggle.BackgroundColor3 = Settings.SyntaxHighlighting and Color3.fromRGB(50, 200, 100) or Color3.fromRGB(200, 50, 50)
	SyntaxToggle.Text = Settings.SyntaxHighlighting and "ON" or "OFF"
	updateLineNumbers()
	ShowNotification("Settings", "Syntax Highlighting " .. (Settings.SyntaxHighlighting and "Enabled" or "Disabled"), "Success", 2)
end)

-- MODIFIED: F8 Label positioned at top right
CloseKeybind.Name = "CloseKeybind"
CloseKeybind.Parent = Topbar
CloseKeybind.BackgroundTransparency = 1
CloseKeybind.Position = UDim2.new(1, -50, 0, 5)
CloseKeybind.Size = UDim2.new(0, 40, 0, 20)
CloseKeybind.Font = Enum.Font.Roboto
CloseKeybind.Text = "[ F8 ]"
CloseKeybind.TextColor3 = Color3.fromRGB(200, 200, 200)
CloseKeybind.TextSize = 14

-- Credits Section (Left of F8)
local CreditsFrame = Instance.new("Frame")
CreditsFrame.Name = "CreditsFrame"
CreditsFrame.Parent = Topbar
CreditsFrame.BackgroundTransparency = 1
CreditsFrame.Position = UDim2.new(1, -180, 0, 5)
CreditsFrame.Size = UDim2.new(0, 125, 0, 20)

local CreditsIcon = Instance.new("ImageLabel")
CreditsIcon.Name = "CreditsIcon"
CreditsIcon.Parent = CreditsFrame
CreditsIcon.BackgroundTransparency = 1
CreditsIcon.Position = UDim2.new(0, 0, 0, 0)
CreditsIcon.Size = UDim2.new(0, 20, 0, 20)
CreditsIcon.Image = "rbxassetid://13048477501"

local CreditsText = Instance.new("TextLabel")
CreditsText.Name = "CreditsText"
CreditsText.Parent = CreditsFrame
CreditsText.BackgroundTransparency = 1
CreditsText.Position = UDim2.new(0, 25, 0, 0)
CreditsText.Size = UDim2.new(1, -25, 1, 0)
CreditsText.Font = Enum.Font.Gotham
CreditsText.Text = 'Credits: "nynxyz_"'
CreditsText.TextColor3 = Color3.fromRGB(180, 180, 180)
CreditsText.TextSize = 12
CreditsText.TextXAlignment = Enum.TextXAlignment.Left

-- MODIFIED: Title with Version 4 Badge (Black/Grey/White) - MORE VISIBLE
TextLabel.Parent = Topbar
TextLabel.BackgroundTransparency = 1
TextLabel.Position = UDim2.new(0, 15, 0, 0)
TextLabel.Size = UDim2.new(0, 300, 0, 40)
TextLabel.Font = Enum.Font.SourceSansBold
TextLabel.Text = "ZZINSWARE"
TextLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel.TextSize = 18
TextLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Logo next to title
local TitleLogo = Instance.new("ImageLabel")
TitleLogo.Name = "TitleLogo"
TitleLogo.Parent = Topbar
TitleLogo.BackgroundTransparency = 1
TitleLogo.Position = UDim2.new(0, 135, 0, 5)
TitleLogo.Size = UDim2.new(0, 30, 0, 30)
TitleLogo.Image = "rbxassetid://114216963895291"

-- Version 4 Badge (Black/Grey/White) - ENHANCED VISIBILITY
local VersionBadge = Instance.new("TextLabel")
VersionBadge.Name = "VersionBadge"
VersionBadge.Parent = Topbar
VersionBadge.BackgroundTransparency = 1
VersionBadge.Position = UDim2.new(0, 330, 0, 8)
VersionBadge.Size = UDim2.new(0, 100, 0, 24)
VersionBadge.Font = Enum.Font.GothamBlack
VersionBadge.Text = "VERSION 4"
VersionBadge.TextSize = 16
VersionBadge.TextStrokeTransparency = 0.8
VersionBadge.TextStrokeColor3 = Color3.fromRGB(255, 255, 255)

-- Create gradient for Black/Grey/White effect
local textGradient = Instance.new("UIGradient")
textGradient.Parent = VersionBadge
textGradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 0, 0)),       -- Black
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(128, 128, 128)), -- Grey
    ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 255, 255))    -- White
})
textGradient.Rotation = 45

-- Add glow effect with multiple labels
local glow1 = VersionBadge:Clone()
glow1.Name = "Glow1"
glow1.Parent = Topbar
glow1.Position = UDim2.new(0, 330, 0, 8)
glow1.TextColor3 = Color3.fromRGB(128, 128, 128)
glow1.TextTransparency = 0.6
glow1.ZIndex = 0

local glow2 = VersionBadge:Clone()
glow2.Name = "Glow2"
glow2.Parent = Topbar
glow2.Position = UDim2.new(0, 330, 0, 8)
glow2.TextColor3 = Color3.fromRGB(255, 255, 255)
glow2.TextTransparency = 0.7
glow2.ZIndex = 0

-- Animate glow
local tweenService = game:GetService("TweenService")
local function animateGlow()
    while true do
        local tween1 = tweenService:Create(textGradient, TweenInfo.new(2, Enum.EasingStyle.Linear), {Rotation = textGradient.Rotation + 180})
        tween1:Play()
        wait(2)
    end
end
coroutine.wrap(animateGlow)()

local UserInputService = game:GetService("UserInputService")
local HttpService = game:GetService("HttpService")

local player = game.Players.LocalPlayer
local savedFiles = {}
local selectedFile = nil

local dragging, dragInput, dragStart, startPos = false, nil, nil, nil

local function update(input)
	local delta = input.Position - dragStart
	Topbar.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

Topbar.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = Topbar.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then dragging = false end
		end)
	end
end)

Topbar.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		dragInput = input
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then update(input) end
end)

local isVisible = true
UserInputService.InputBegan:Connect(function(Input, g)
	if not g and Input.KeyCode == Enum.KeyCode.F8 then
		isVisible = not isVisible
		Topbar.Visible = isVisible
	end
end)

local function SwitchTab(tab)
	InfoTab.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	InfoTab.ImageColor3 = Color3.fromRGB(150, 150, 150)
	EditorTab.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	EditorTab.ImageColor3 = Color3.fromRGB(150, 150, 150)
	SearcherTab.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	SearcherTab.ImageColor3 = Color3.fromRGB(150, 150, 150)
	GameScriptsTab.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	GameScriptsTab.ImageColor3 = Color3.fromRGB(150, 150, 150)
	UniversalScriptsTab.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	UniversalScriptsTab.ImageColor3 = Color3.fromRGB(150, 150, 150)
	SettingsTab.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	SettingsTab.ImageColor3 = Color3.fromRGB(150, 150, 150)
	
	InfoFrame.Visible = false
	EditorFrame.Visible = false
	SearcherFrame.Visible = false
	GameScriptsFrame.Visible = false
	UniversalScriptsFrame.Visible = false
	SettingsFrame.Visible = false
	
	if tab == "Info" then
		InfoTab.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		InfoTab.ImageColor3 = Color3.fromRGB(255, 255, 255)
		InfoFrame.Visible = true
	elseif tab == "Editor" then
		EditorTab.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		EditorTab.ImageColor3 = Color3.fromRGB(255, 255, 255)
		EditorFrame.Visible = true
	elseif tab == "Searcher" then
		SearcherTab.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		SearcherTab.ImageColor3 = Color3.fromRGB(255, 255, 255)
		SearcherFrame.Visible = true
	elseif tab == "GameScripts" then
		GameScriptsTab.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		GameScriptsTab.ImageColor3 = Color3.fromRGB(255, 255, 255)
		GameScriptsFrame.Visible = true
	elseif tab == "UniversalScripts" then
		UniversalScriptsTab.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		UniversalScriptsTab.ImageColor3 = Color3.fromRGB(255, 255, 255)
		UniversalScriptsFrame.Visible = true
	elseif tab == "Settings" then
		SettingsTab.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		SettingsTab.ImageColor3 = Color3.fromRGB(255, 255, 255)
		SettingsFrame.Visible = true
	end
end

InfoTab.MouseButton1Click:Connect(function() SwitchTab("Info") end)
EditorTab.MouseButton1Click:Connect(function() SwitchTab("Editor") end)
SearcherTab.MouseButton1Click:Connect(function() SwitchTab("Searcher") end)
GameScriptsTab.MouseButton1Click:Connect(function() SwitchTab("GameScripts") end)
UniversalScriptsTab.MouseButton1Click:Connect(function() SwitchTab("UniversalScripts") end)
SettingsTab.MouseButton1Click:Connect(function() SwitchTab("Settings") end)

CopyDiscordBtn.MouseButton1Click:Connect(function()
	local success = pcall(function()
		if setclipboard then
			setclipboard("https://discord.gg/xnVDpcAYgC")
		end
	end)
	if not success then
		ShowNotification("Error", "Failed to copy to clipboard", "Error", 3)
	end
end)

OpenConsole.MouseButton1Click:Connect(function()
	local success = pcall(function()
		if game:GetService("StarterGui"):GetCore("DevConsoleVisible") ~= nil then
			game:GetService("StarterGui"):SetCore("DevConsoleVisible", true)
		end
	end)
	if not success then
		ShowNotification("Error", "Failed to open console", "Error", 3)
	end
end)

Execute.MouseButton1Click:Connect(function()
	if Source.Text == "" then
		ShowNotification("Error", "No script to execute", "Error", 3)
		return
	end
	Settings.LastScript = Source.Text
	local success, err = pcall(function()
		loadstring(Source.Text)()
	end)
	if not success then
		ShowNotification("Execution Failed", tostring(err):sub(1, 100), "Error", 5)
	else
		game:GetService("StarterGui"):SetCore("SendNotification", {
			Title = "[ðŸ””] ZZINSWARE",
			Text = "Thanks for Using ZZINS Script-Hub.",
			Duration = 5
		})
	end
end)

Clear.MouseButton1Click:Connect(function() 
	Source.Text = "" 
end)

Paste.MouseButton1Click:Connect(function()
	local success, result = pcall(function()
		return getclipboard and getclipboard() or ""
	end)
	if success and result ~= "" then
		Source.Text = result
	else
		ShowNotification("Error", "Failed to paste from clipboard", "Error", 3)
	end
end)

Copy.MouseButton1Click:Connect(function()
	if Source.Text == "" then
		ShowNotification("Error", "No text to copy", "Error", 3)
		return
	end
	local success = pcall(function()
		if setclipboard then
			setclipboard(Source.Text)
		end
	end)
	if not success then
		ShowNotification("Error", "Failed to copy to clipboard", "Error", 3)
	else
		ShowNotification("Success", "Text copied to clipboard", "Success", 2)
	end
end)

local function refreshFilesList()
	for _, child in pairs(FilesList:GetChildren()) do
		if child:IsA("TextButton") then
			child:Destroy()
		end
	end
	
	for name, _ in pairs(savedFiles) do
		local fileBtn = Instance.new("TextButton")
		fileBtn.Size = UDim2.new(1, 0, 0, 28)
		fileBtn.BackgroundColor3 = (selectedFile == name) and Color3.fromRGB(50, 50, 50) or Color3.fromRGB(30, 30, 30)
		fileBtn.Text = name
		fileBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
		fileBtn.TextSize = 11
		fileBtn.Font = Enum.Font.Gotham
		fileBtn.Parent = FilesList
		
		Instance.new("UICorner", fileBtn).CornerRadius = UDim.new(0, 4)
		
		fileBtn.MouseButton1Click:Connect(function()
			selectedFile = name
			FileNameBox.Text = name
			refreshFilesList()
		end)
	end
	
	FilesList.CanvasSize = UDim2.new(0, 0, 0, #savedFiles * 32)
end

SaveFileBtn.MouseButton1Click:Connect(function()
	local name = FileNameBox.Text
	if name == "" then name = "Script_" .. os.time() end
	if Source.Text == "" then
		ShowNotification("Error", "No script to save", "Error", 3)
		return
	end
	savedFiles[name] = Source.Text
	selectedFile = name
	refreshFilesList()
	ShowNotification("Success", "Script saved as '" .. name .. "'", "Success", 2)
end)

LoadFileBtn.MouseButton1Click:Connect(function()
	if selectedFile and savedFiles[selectedFile] then
		Source.Text = savedFiles[selectedFile]
		FileNameBox.Text = selectedFile
	elseif FileNameBox.Text ~= "" and savedFiles[FileNameBox.Text] then
		Source.Text = savedFiles[FileNameBox.Text]
		selectedFile = FileNameBox.Text
		refreshFilesList()
	else
		ShowNotification("Error", "No file selected", "Error", 3)
	end
end)

RenameFileBtn.MouseButton1Click:Connect(function()
	local oldName = selectedFile or FileNameBox.Text
	local newName = FileNameBox.Text
	if not oldName or not savedFiles[oldName] then
		ShowNotification("Error", "No file selected to rename", "Error", 3)
		return
	end
	if newName == "" then
		ShowNotification("Error", "Enter new name", "Error", 3)
		return
	end
	if newName == oldName then
		ShowNotification("Error", "New name must be different", "Error", 3)
		return
	end
	savedFiles[newName] = savedFiles[oldName]
	savedFiles[oldName] = nil
	selectedFile = newName
	refreshFilesList()
	ShowNotification("Success", "Renamed to '" .. newName .. "'", "Success", 2)
end)

DeleteFileBtn.MouseButton1Click:Connect(function()
	local name = selectedFile or FileNameBox.Text
	if not savedFiles[name] then
		ShowNotification("Error", "No file selected to delete", "Error", 3)
		return
	end
	savedFiles[name] = nil
	if selectedFile == name then selectedFile = nil end
	FileNameBox.Text = ""
	refreshFilesList()
	ShowNotification("Success", "File deleted", "Success", 2)
end)

ExecuteFileBtn.MouseButton1Click:Connect(function()
	local name = selectedFile or FileNameBox.Text
	if not savedFiles[name] then
		ShowNotification("Error", "No file selected to execute", "Error", 3)
		return
	end
	Settings.LastScript = savedFiles[name]
	local success, err = pcall(function()
		loadstring(savedFiles[name])()
	end)
	if not success then
		ShowNotification("Execution Failed", tostring(err):sub(1, 100), "Error", 5)
	else
		game:GetService("StarterGui"):SetCore("SendNotification", {
			Title = "[ðŸ””] ZZINSWARE",
			Text = "Thanks for Using ZZINS Script-Hub.",
			Duration = 5
		})
	end
end)

local CurrentPage = 1
local CurrentQuery = ""
local CurrentFilter = ""
local ScriptsPerPage = 6
local TotalPages = 1

local function SearchScriptBlox(query, page)
	CurrentQuery = query
	CurrentPage = page or 1
	
	local results = {}
	local apiUrl
	
	if CurrentFilter == "trending" then
		apiUrl = "https://scriptblox.com/api/script/trending?page=" .. CurrentPage .. "&max=" .. ScriptsPerPage
	elseif CurrentFilter ~= "" then
		apiUrl = "https://scriptblox.com/api/script/fetch?" .. CurrentFilter .. "&page=" .. CurrentPage .. "&max=" .. ScriptsPerPage
	else
		apiUrl = "https://scriptblox.com/api/script/search?q=" .. HttpService:UrlEncode(query) .. "&page=" .. CurrentPage .. "&max=" .. ScriptsPerPage
	end
	
	local success, response = pcall(function()
		return game:HttpGet(apiUrl)
	end)
	
	if success and response then
		local data = HttpService:JSONDecode(response)
		if data and data.result and data.result.scripts then
			for i, script in pairs(data.result.scripts) do
				table.insert(results, {
					name = script.title or "Unknown",
					desc = "By " .. (script.owner and script.owner.username or "Unknown") .. " | " .. (script.game and script.game.name or "Universal") .. " | " .. (script.views or 0) .. " views",
					code = script.script or "",
					image = script.game and script.game.imageUrl or "",
					verified = script.verified or false,
					key = script.key or false,
					scriptType = script.scriptType or "normal",
					isPatched = script.isPatched or false,
					isUniversal = script.isUniversal or false,
					slug = script.slug or ""
				})
			end
			
			if data.result.total then
				TotalPages = math.ceil(data.result.total / ScriptsPerPage)
				PageLabel.Text = CurrentPage .. "/" .. TotalPages
			else
				TotalPages = 999
				PageLabel.Text = tostring(CurrentPage)
			end
		end
	end
	
	return results
end

local function GetScriptDetails(slug)
	local success, response = pcall(function()
		return game:HttpGet("https://scriptblox.com/api/script/" .. slug .. "?legacy_tags=true")
	end)
	
	if success and response then
		local data = HttpService:JSONDecode(response)
		if data and data.result then
			return data.result.script
		end
	end
	return nil
end

local function CreateScriptButton(data, parent)
	local Btn = Instance.new("Frame")
	Btn.Size = UDim2.new(1, -10, 0, 80)
	Btn.Position = UDim2.new(0, 5, 0, 0)
	Btn.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	Btn.BorderSizePixel = 0
	Btn.Parent = parent
	
	Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 6)
	
	local Thumbnail = Instance.new("ImageLabel")
	Thumbnail.Name = "Thumbnail"
	Thumbnail.Size = UDim2.new(0, 60, 0, 60)
	Thumbnail.Position = UDim2.new(0, 10, 0, 10)
	Thumbnail.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	Thumbnail.ScaleType = Enum.ScaleType.Crop
	Thumbnail.Parent = Btn
	
	Instance.new("UICorner", Thumbnail).CornerRadius = UDim.new(0, 4)
	
	if data.image and data.image ~= "" then
		Thumbnail.Image = data.image
	else
		Thumbnail.Image = "rbxassetid://9405926389"
	end
	
	local BadgeFrame = Instance.new("Frame")
	BadgeFrame.Size = UDim2.new(0, 200, 0, 16)
	BadgeFrame.Position = UDim2.new(0, 75, 0, 8)
	BadgeFrame.BackgroundTransparency = 1
	BadgeFrame.Parent = Btn
	
	local badgeOffset = 0
	
	if data.verified then
		local Verified = Instance.new("ImageLabel")
		Verified.Size = UDim2.new(0, 16, 0, 16)
		Verified.Position = UDim2.new(0, badgeOffset, 0, 0)
		Verified.BackgroundTransparency = 1
		Verified.Image = "rbxassetid://11839277083"
		Verified.ImageColor3 = Color3.fromRGB(200, 200, 200)
		Verified.Parent = BadgeFrame
		badgeOffset = badgeOffset + 20
	end
	
	if data.isUniversal then
		local UniBadge = Instance.new("TextLabel")
		UniBadge.Size = UDim2.new(0, 50, 0, 16)
		UniBadge.Position = UDim2.new(0, badgeOffset, 0, 0)
		UniBadge.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
		UniBadge.Text = "UNIVERSAL"
		UniBadge.TextColor3 = Color3.fromRGB(255, 255, 255)
		UniBadge.TextSize = 7
		UniBadge.Font = Enum.Font.GothamBold
		UniBadge.Parent = BadgeFrame
		Instance.new("UICorner", UniBadge).CornerRadius = UDim.new(0, 3)
		badgeOffset = badgeOffset + 55
	end
	
	if data.key then
		local KeyBadge = Instance.new("TextLabel")
		KeyBadge.Size = UDim2.new(0, 30, 0, 16)
		KeyBadge.Position = UDim2.new(0, badgeOffset, 0, 0)
		KeyBadge.BackgroundColor3 = Color3.fromRGB(150, 150, 150)
		KeyBadge.Text = "KEY"
		KeyBadge.TextColor3 = Color3.fromRGB(255, 255, 255)
		KeyBadge.TextSize = 8
		KeyBadge.Font = Enum.Font.GothamBold
		KeyBadge.Parent = BadgeFrame
		Instance.new("UICorner", KeyBadge).CornerRadius = UDim.new(0, 3)
		badgeOffset = badgeOffset + 35
	end
	
	if data.isPatched then
		local PatchedBadge = Instance.new("TextLabel")
		PatchedBadge.Size = UDim2.new(0, 50, 0, 16)
		PatchedBadge.Position = UDim2.new(0, badgeOffset, 0, 0)
		PatchedBadge.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
		PatchedBadge.Text = "PATCHED"
		PatchedBadge.TextColor3 = Color3.fromRGB(255, 255, 255)
		PatchedBadge.TextSize = 8
		PatchedBadge.Font = Enum.Font.GothamBold
		PatchedBadge.Parent = BadgeFrame
		Instance.new("UICorner", PatchedBadge).CornerRadius = UDim.new(0, 3)
		badgeOffset = badgeOffset + 55
	end
	
	if data.scriptType == "paid" then
		local PaidBadge = Instance.new("TextLabel")
		PaidBadge.Size = UDim2.new(0, 30, 0, 16)
		PaidBadge.Position = UDim2.new(0, badgeOffset, 0, 0)
		PaidBadge.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
		PaidBadge.Text = "PAID"
		PaidBadge.TextColor3 = Color3.fromRGB(0, 0, 0)
		PaidBadge.TextSize = 8
		PaidBadge.Font = Enum.Font.GothamBold
		PaidBadge.Parent = BadgeFrame
		Instance.new("UICorner", PaidBadge).CornerRadius = UDim.new(0, 3)
	end
	
	local Title = Instance.new("TextLabel")
	Title.Size = UDim2.new(1, -150, 0, 18)
	Title.Position = UDim2.new(0, 75, 0, 28)
	Title.BackgroundTransparency = 1
	Title.Text = data.name
	Title.TextColor3 = Color3.fromRGB(255, 255, 255)
	Title.TextSize = 13
	Title.Font = Enum.Font.GothamBold
	Title.TextXAlignment = Enum.TextXAlignment.Left
	Title.TextTruncate = Enum.TextTruncate.AtEnd
	Title.Parent = Btn
	
	local Desc = Instance.new("TextLabel")
	Desc.Size = UDim2.new(1, -150, 0, 25)
	Desc.Position = UDim2.new(0, 75, 0, 48)
	Desc.BackgroundTransparency = 1
	Desc.Text = data.desc
	Desc.TextColor3 = Color3.fromRGB(150, 150, 150)
	Desc.TextSize = 10
	Desc.Font = Enum.Font.Gotham
	Desc.TextXAlignment = Enum.TextXAlignment.Left
	Desc.TextYAlignment = Enum.TextYAlignment.Top
	Desc.TextWrapped = true
	Desc.Parent = Btn
	
	local ExecBtn = Instance.new("ImageButton")
	ExecBtn.Name = "Execute"
	ExecBtn.Size = UDim2.new(0, 30, 0, 30)
	ExecBtn.Position = UDim2.new(1, -70, 0, 15)
	ExecBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	ExecBtn.Image = "rbxassetid://119065240115720"
	ExecBtn.ImageColor3 = Color3.fromRGB(255, 255, 255)
	ExecBtn.Parent = Btn
	
	Instance.new("UICorner", ExecBtn).CornerRadius = UDim.new(0, 4)
	
	-- ENHANCED: PC-style tooltip for Execute
	local ExecBtnTooltip = Instance.new("Frame")
	ExecBtnTooltip.Name = "ExecBtnTooltip"
	ExecBtnTooltip.Parent = ExecBtn
	ExecBtnTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
	ExecBtnTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
	ExecBtnTooltip.BorderSizePixel = 1
	ExecBtnTooltip.Position = UDim2.new(0, 0, 0, -28)
	ExecBtnTooltip.Size = UDim2.new(0, 60, 0, 22)
	ExecBtnTooltip.Visible = false
	ExecBtnTooltip.ZIndex = 10

	local ExecBtnTooltipCorner = Instance.new("UICorner")
	ExecBtnTooltipCorner.CornerRadius = UDim.new(0, 4)
	ExecBtnTooltipCorner.Parent = ExecBtnTooltip

	local ExecBtnTooltipText = Instance.new("TextLabel")
	ExecBtnTooltipText.Parent = ExecBtnTooltip
	ExecBtnTooltipText.BackgroundTransparency = 1
	ExecBtnTooltipText.Size = UDim2.new(1, 0, 1, 0)
	ExecBtnTooltipText.Font = Enum.Font.GothamSemibold
	ExecBtnTooltipText.Text = "Execute"
	ExecBtnTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
	ExecBtnTooltipText.TextSize = 11
	ExecBtnTooltipText.ZIndex = 11

	ExecBtn.MouseEnter:Connect(function()
		ExecBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
		ExecBtnTooltip.Visible = true
	end)
	ExecBtn.MouseLeave:Connect(function()
		ExecBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
		ExecBtnTooltip.Visible = false
	end)
	
	ExecBtn.MouseButton1Click:Connect(function()
		if data.code and data.code ~= "" then
			local success, err = pcall(function()
				loadstring(data.code)()
			end)
			if not success then
				ShowNotification("Execution Failed", tostring(err):sub(1, 100), "Error", 5)
			else
				game:GetService("StarterGui"):SetCore("SendNotification", {
					Title = "[ðŸ””] ZZINSWARE",
					Text = "Thanks for Using ZZINS Script-Hub.",
					Duration = 5
				})
			end
		elseif data.slug ~= "" then
			local details = GetScriptDetails(data.slug)
			if details and details.script then
				local success, err = pcall(function()
					loadstring(details.script)()
				end)
				if not success then
					ShowNotification("Execution Failed", tostring(err):sub(1, 100), "Error", 5)
				else
					game:GetService("StarterGui"):SetCore("SendNotification", {
						Title = "[ðŸ””] ZZINSWARE",
						Text = "Thanks for Using ZZINS Script-Hub.",
						Duration = 5
					})
				end
			else
				ShowNotification("Error", "Failed to load script details", "Error", 3)
			end
		else
			ShowNotification("Error", "No script code available", "Error", 3)
		end
	end)
	
	local CopyBtn = Instance.new("ImageButton")
	CopyBtn.Name = "Copy"
	CopyBtn.Size = UDim2.new(0, 30, 0, 30)
	CopyBtn.Position = UDim2.new(1, -35, 0, 15)
	CopyBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	CopyBtn.Image = "rbxassetid://127935026620905"
	CopyBtn.ImageColor3 = Color3.fromRGB(255, 255, 255)
	CopyBtn.Parent = Btn
	
	Instance.new("UICorner", CopyBtn).CornerRadius = UDim.new(0, 4)
	
	-- ENHANCED: PC-style tooltip for Copy
	local CopyBtnTooltip = Instance.new("Frame")
	CopyBtnTooltip.Name = "CopyBtnTooltip"
	CopyBtnTooltip.Parent = CopyBtn
	CopyBtnTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
	CopyBtnTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
	CopyBtnTooltip.BorderSizePixel = 1
	CopyBtnTooltip.Position = UDim2.new(0, 0, 0, -28)
	CopyBtnTooltip.Size = UDim2.new(0, 60, 0, 22)
	CopyBtnTooltip.Visible = false
	CopyBtnTooltip.ZIndex = 10

	local CopyBtnTooltipCorner = Instance.new("UICorner")
	CopyBtnTooltipCorner.CornerRadius = UDim.new(0, 4)
	CopyBtnTooltipCorner.Parent = CopyBtnTooltip

	local CopyBtnTooltipText = Instance.new("TextLabel")
	CopyBtnTooltipText.Parent = CopyBtnTooltip
	CopyBtnTooltipText.BackgroundTransparency = 1
	CopyBtnTooltipText.Size = UDim2.new(1, 0, 1, 0)
	CopyBtnTooltipText.Font = Enum.Font.GothamSemibold
	CopyBtnTooltipText.Text = "Copy"
	CopyBtnTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
	CopyBtnTooltipText.TextSize = 11
	CopyBtnTooltipText.ZIndex = 11

	CopyBtn.MouseEnter:Connect(function()
		CopyBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		CopyBtnTooltip.Visible = true
	end)
	CopyBtn.MouseLeave:Connect(function()
		CopyBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
		CopyBtnTooltip.Visible = false
	end)
	
	CopyBtn.MouseButton1Click:Connect(function()
		if data.code and data.code ~= "" then
			Source.Text = data.code
			SwitchTab("Editor")
		elseif data.slug ~= "" then
			local details = GetScriptDetails(data.slug)
			if details and details.script then
				Source.Text = details.script
				SwitchTab("Editor")
			else
				ShowNotification("Error", "Failed to load script details", "Error", 3)
			end
		else
			ShowNotification("Error", "No script code available", "Error", 3)
		end
	end)
	
	local ViewBtn = Instance.new("ImageButton")
	ViewBtn.Name = "View"
	ViewBtn.Size = UDim2.new(0, 30, 0, 30)
	ViewBtn.Position = UDim2.new(1, -70, 0, 50)
	ViewBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	ViewBtn.Image = "rbxassetid://11713325834"
	ViewBtn.ImageColor3 = Color3.fromRGB(255, 255, 255)
	ViewBtn.Parent = Btn
	
	Instance.new("UICorner", ViewBtn).CornerRadius = UDim.new(0, 4)
	
	-- ENHANCED: PC-style tooltip for View
	local ViewBtnTooltip = Instance.new("Frame")
	ViewBtnTooltip.Name = "ViewBtnTooltip"
	ViewBtnTooltip.Parent = ViewBtn
	ViewBtnTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
	ViewBtnTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
	ViewBtnTooltip.BorderSizePixel = 1
	ViewBtnTooltip.Position = UDim2.new(0, 0, 0, -28)
	ViewBtnTooltip.Size = UDim2.new(0, 60, 0, 22)
	ViewBtnTooltip.Visible = false
	ViewBtnTooltip.ZIndex = 10

	local ViewBtnTooltipCorner = Instance.new("UICorner")
	ViewBtnTooltipCorner.CornerRadius = UDim.new(0, 4)
	ViewBtnTooltipCorner.Parent = ViewBtnTooltip

	local ViewBtnTooltipText = Instance.new("TextLabel")
	ViewBtnTooltipText.Parent = ViewBtnTooltip
	ViewBtnTooltipText.BackgroundTransparency = 1
	ViewBtnTooltipText.Size = UDim2.new(1, 0, 1, 0)
	ViewBtnTooltipText.Font = Enum.Font.GothamSemibold
	ViewBtnTooltipText.Text = "View"
	ViewBtnTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
	ViewBtnTooltipText.TextSize = 11
	ViewBtnTooltipText.ZIndex = 11

	ViewBtn.MouseEnter:Connect(function()
		ViewBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		ViewBtnTooltip.Visible = true
	end)
	ViewBtn.MouseLeave:Connect(function()
		ViewBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
		ViewBtnTooltip.Visible = false
	end)
	
	ViewBtn.MouseButton1Click:Connect(function()
		if data.slug ~= "" then
			local details = GetScriptDetails(data.slug)
			if details then
				local infoText = "Title: " .. (details.title or "Unknown") .. "\n"
				infoText = infoText .. "Game: " .. (details.game and details.game.name or "Universal") .. "\n"
				infoText = infoText .. "Views: " .. (details.views or 0) .. "\n"
				infoText = infoText .. "Verified: " .. tostring(details.verified or false) .. "\n"
				infoText = infoText .. "Key Required: " .. tostring(details.key or false) .. "\n"
				infoText = infoText .. "Patched: " .. tostring(details.isPatched or false) .. "\n"
				infoText = infoText .. "Created: " .. (details.createdAt or "Unknown")
				
				Source.Text = "-- Script Info:\n-- " .. infoText:gsub("\n", "\n-- ") .. "\n\n" .. (details.script or "-- No script code available")
				SwitchTab("Editor")
			else
				ShowNotification("Error", "Failed to load script details", "Error", 3)
			end
		else
			ShowNotification("Error", "No script details available", "Error", 3)
		end
	end)
end

local function ClearList(parent)
	for _, child in pairs(parent:GetChildren()) do
		if child:IsA("Frame") then
			child:Destroy()
		end
	end
end

local function PerformSearch()
	local query = SearchBox.Text
	if query == "" and CurrentFilter == "" then 
		ShowNotification("Error", "Enter search query or select filter", "Error", 3)
		return 
	end
	
	ClearList(ScriptList)
	
	local Loading = Instance.new("TextLabel")
	Loading.Size = UDim2.new(1, 0, 0, 50)
	Loading.Position = UDim2.new(0, 0, 0, 80)
	Loading.BackgroundTransparency = 1
	Loading.Text = "Searching..."
	Loading.TextColor3 = Color3.fromRGB(255, 255, 255)
	Loading.TextSize = 14
	Loading.Parent = ScriptList
	
	local results = SearchScriptBlox(query, CurrentPage)
	Loading:Destroy()
	
	if #results == 0 then
		local NoResults = Instance.new("TextLabel")
		NoResults.Size = UDim2.new(1, 0, 0, 50)
		NoResults.Position = UDim2.new(0, 0, 0, 80)
		NoResults.BackgroundTransparency = 1
		NoResults.Text = "No results found"
		NoResults.TextColor3 = Color3.fromRGB(255, 100, 100)
		NoResults.TextSize = 14
		NoResults.Parent = ScriptList
	else
		for _, script in pairs(results) do
			CreateScriptButton(script, ScriptList)
		end
	end
	
	ScriptList.CanvasSize = UDim2.new(0, 0, 0, ListLayout.AbsoluteContentSize.Y + 10)
end

SearchButton.MouseButton1Click:Connect(PerformSearch)

SearchBox.FocusLost:Connect(function(enterPressed)
	if enterPressed then
		PerformSearch()
	end
end)

NextPageBtn.MouseButton1Click:Connect(function()
	if CurrentPage < TotalPages then
		CurrentPage = CurrentPage + 1
		PerformSearch()
	else
		ShowNotification("Error", "Already on last page", "Error", 3)
	end
end)

PrevPageBtn.MouseButton1Click:Connect(function()
	if CurrentPage > 1 then
		CurrentPage = CurrentPage - 1
		PerformSearch()
	else
		ShowNotification("Error", "Already on first page", "Error", 3)
	end
end)

local gameScripts = {
	{name = "Siren Head: LEGACY", url = "https://raw.githubusercontent.com/ZZINSWARE/Siren-Head-LEGACY/refs/heads/main/ZZINSWARE"},
	{name = "The Rake Remastered", url = "https://raw.githubusercontent.com/ZZINSWARE/The-Rake-Remastered/refs/heads/main/ZZINSWARE"},
	{name = "Feel The Facility", url = "https://raw.githubusercontent.com/ZZINSWARE/Feel-The-Facility/refs/heads/main/ZZINSWARE"},
	{name = "Death Note", url = "https://raw.githubusercontent.com/ZZINSWARE/Death-Note/refs/heads/main/ZZINSWARE"},
	{name = "99 Nights in The Forest", url = "https://raw.githubusercontent.com/ZZINSWARE/99-Nights-In-The-Forest/refs/heads/main/ZZINSWARE"},
	{name = "Fluffy Infection", url = "https://raw.githubusercontent.com/ZZINSWARE/Fluffy-Infection/refs/heads/main/ZZINSWARE"},
	{name = "3008", url = "https://raw.githubusercontent.com/ZZINSWARE/3008/refs/heads/main/ZZINSWARE"},
	{name = "Infectious Smile", url = "https://raw.githubusercontent.com/ZZINSWARE/Infectious-Smile/main/ZZINSWARE"},
	{name = "Another Infection Game", url = "https://raw.githubusercontent.com/ZZINSWARE/Another-Infection-Game/refs/heads/main/ZZINSWARE"},
	{name = "Zombie Attack", url = "https://raw.githubusercontent.com/ZZINSWARE/Zombie-Attack/refs/heads/main/ZZINSWARE"},
	{name = "Gun Grounds FFA", url = "https://raw.githubusercontent.com/ZZINS077/Gun-Grounds-FFA/refs/heads/main/ZZINSHUB"},
	{name = "Hunty Zombie", url = "https://raw.githubusercontent.com/ZZINSWARE/Hunty-Zombie/refs/heads/main/ZZINSWARE"},
	{name = "Zombie RNG", url = "https://raw.githubusercontent.com/ZZINSWARE/Zombie-RNG/refs/heads/main/ZZINSWARE"},
	{name = "Blade X Zombies", url = "https://raw.githubusercontent.com/ZZINSWARE/Blade-X-Zombies/refs/heads/main/ZZINSWARE"},
	{name = "Zombie Rush", url = "https://raw.githubusercontent.com/ZZINSWARE/Zombie-Rush/refs/heads/main/ZZINSWARE"},
	{name = "Noobs Must Die", url = "https://raw.githubusercontent.com/ZZINS077/Noobs-Must-die/main/ZZINSHUB"},
	{name = "Noob Invaders", url = "https://raw.githubusercontent.com/ZZINSWARE/Noob-Invaders/refs/heads/main/ZZINSWARE"},
	{name = "Arsenal", url = "https://raw.githubusercontent.com/ZZINSWARE/Arsneal/main/ZZINSWARE"},
	{name = "Fortline", url = "https://raw.githubusercontent.com/ZZINSWARE/Fortline/refs/heads/main/ZZINSHUB"},
	{name = "Combat Arena", url = "https://raw.githubusercontent.com/ZZINSWARE/Combat-Arena/refs/heads/main/ZZINSWARE"},
	{name = "The Last Front", url = "https://raw.githubusercontent.com/ZZINSWARE/The-Last-Front/refs/heads/main/ZZINSWARE"},
	{name = "Blade Ball", url = "https://raw.githubusercontent.com/ZZINSWARE/Blade-Ball/refs/heads/main/ZZINSWARE"},
	{name = "Death Ball", url = "https://raw.githubusercontent.com/ZZINSWARE/Death-Ball/refs/heads/main/ZZINSWARE"},
	{name = "Blind Shot", url = "https://raw.githubusercontent.com/ZZINSWARE/Blind-Shot/refs/heads/main/ZZINSWARE"},
	{name = "Tower of Hell", url = "https://raw.githubusercontent.com/ZZINS077/Tower-of-Hell/refs/heads/main/ZZINS%20HUB"},
	{name = "Tower of Jump", url = "https://raw.githubusercontent.com/ZZINSWARE/Tower-Of-Jump/refs/heads/main/ZZINSWARE"},
	{name = "Brainrot Tower", url = "https://raw.githubusercontent.com/ZZINSWARE/Brainrot-Tower/refs/heads/main/ZZINSWARE"},
	{name = "Prop Morph Tower", url = "https://raw.githubusercontent.com/ZZINSWARE/Prop-Morph-Tower/refs/heads/main/ZZINSWARE"},
	{name = "a Dusty Trip", url = "https://raw.githubusercontent.com/ZZINSWARE/a-Dusty-Trip/refs/heads/main/ZZINSWARE"},
	{name = "Build a Boat For Treasure", url = "https://raw.githubusercontent.com/ZZINSWARE/Build-a-Boat-For-Treasure/refs/heads/main/ZZINSWARE"},
	{name = "Blox Fruits", url = "https://raw.githubusercontent.com/ZZINSWARE/Blox-fruits/refs/heads/main/ZZINSWARE"},
	{name = "Anime Final Quest", url = "https://raw.githubusercontent.com/ZZINSWARE/Anime-Final-Quest/refs/heads/main/ZZINSWARE"},
	{name = "Elemental Dungeons", url = "https://raw.githubusercontent.com/ZZINSWARE/Elemental-Dungeons/refs/heads/main/ZZINZWARE"},
	{name = "Dungeon Heros", url = "https://raw.githubusercontent.com/ZZINSWARE/Dungeon-Heros/refs/heads/main/ZZINSWARE"},
	{name = "Legends of Speed", url = "https://raw.githubusercontent.com/ZZINSWARE/Legends-of-Speed/refs/heads/main/ZZINSWARE"},
	{name = "Last Run", url = "https://raw.githubusercontent.com/ZZINSWARE/Last-Run/refs/heads/main/ZZINSWARE"},
	{name = "Plants Vs Brainrots", url = "https://raw.githubusercontent.com/ZZINSWARE/Plants-vs-Brainrots/refs/heads/main/ZZINSWARE"},
	{name = "Fish a Brainrot", url = "https://raw.githubusercontent.com/ZZINSWARE/Fish-a-Brainrot-/refs/heads/main/ZZINSWARE"},
	{name = "My Fishing Brainrots", url = "https://raw.githubusercontent.com/ZZINSWARE/My-Fishing-Brainrots/refs/heads/main/ZZINSWARE"},
	{name = "Smack The Brainrots", url = "https://raw.githubusercontent.com/ZZINSWARE/Smack-The-Brainrots/refs/heads/main/ZZINSWARE"},
	{name = "Poop a Brainrot", url = "https://raw.githubusercontent.com/ZZINSWARE/Poop-a-Brainrot/refs/heads/main/ZZINSWARE"},
	{name = "Find The Brainrots", url = "https://raw.githubusercontent.com/ZZINSWARE/Find-The-Brainrots/refs/heads/main/ZZINSWARE"},
	{name = "Poop a Big Poop", url = "https://raw.githubusercontent.com/ZZINSWARE/Poop-a-Big-Poop/refs/heads/main/ZZINSWARE"},
	{name = "Poop Everything", url = "https://raw.githubusercontent.com/ZZINSWARE/Poop-Everything/refs/heads/main/ZZINSWARE"},
	{name = "Iq Test", url = "https://raw.githubusercontent.com/ZZINSWARE/IQ-Test/refs/heads/main/ZZINSWARE"},
	{name = "Emote RNG", url = "https://raw.githubusercontent.com/ZZINSWARE/Emote-RNG/refs/heads/main/ZZINSWARE"},
	{name = "Drill For Ores", url = "https://raw.githubusercontent.com/ZZINSWARE/Drill-For-Ores/refs/heads/main/ZZINSWARE"},
	{name = "Fisch", url = "https://raw.githubusercontent.com/ZZINSWARE/Fisch/refs/heads/main/ZZINSWARE"},
	{name = "Go Fishing", url = "https://raw.githubusercontent.com/ZZINSWARE/Go-Fishing/refs/heads/main/ZZINSWARE"},
	{name = "Sword Fishing", url = "https://raw.githubusercontent.com/ZZINSWARE/Sword-Fishing/refs/heads/main/ZZINSWARE"},
	{name = "Throw a Basketball", url = "https://raw.githubusercontent.com/ZZINSWARE/Throw-a-Basketball/refs/heads/main/ZZINSWARE"},
	{name = "Blue Lock Rivals", url = "https://raw.githubusercontent.com/ZZINSWARE/Blue-Lock-Rivals/refs/heads/main/ZZINSWARE"},
	{name = "Flick", url = "https://raw.githubusercontent.com/ZZINSWARE/Flick/refs/heads/main/ZZINSWARE"},
	{name = "Funky Friday", url = "https://raw.githubusercontent.com/ZZINSWARE/Funky-Friday/refs/heads/main/ZZINSWARE"},
	{name = "Lucky Block BattleGrounds", url = "https://raw.githubusercontent.com/ZZINSWARE/Lucky-block-Battlegrounds/refs/heads/main/ZZINSWARE"},
	{name = "Animal Simulator", url = "https://raw.githubusercontent.com/ZZINSWARE/Animal-Simulator/main/ZZINSWARE"},
	{name = "Vehicle Legends Cars", url = "https://raw.githubusercontent.com/ZZINSWARE/Vehicle-Legends-Cars/main/ZZINSWARE"},
	{name = "Cut Trees", url = "https://raw.githubusercontent.com/ZZINSWARE/Cut-Trees/refs/heads/main/ZZINSWARE"},
	{name = "Chop Your Tree", url = "https://raw.githubusercontent.com/ZZINSWARE/Chop-your-Tree/refs/heads/main/ZZINSWARE"},
	{name = "Meme Sea", url = "https://raw.githubusercontent.com/ZZINSWARE/Meme-Sea/refs/heads/main/ZZINSWARE"},
	{name = "The Forge", url = "https://raw.githubusercontent.com/ZZINSWARE/The-Forge/refs/heads/main/ZZINSWARE"},
	{name = "Lootify", url = "https://raw.githubusercontent.com/ZZINSWARE/Lootify/refs/heads/main/ZZINSWARE"},
	{name = "Voxels", url = "https://raw.githubusercontent.com/ZZINSWARE/Voxels/main/ZZINSWARE"},
	{name = "67 Tag", url = "https://raw.githubusercontent.com/ZZINSWARE/67-Tag/refs/heads/main/ZZINSWARE"},
	{name = "You Vs Homer", url = "https://raw.githubusercontent.com/ZZINSWARE/You-Vs-Homer/refs/heads/main/ZZINSWARE"},
	{name = "Hero Loot", url = "https://raw.githubusercontent.com/ZZINSWARE/Hero-Loot/refs/heads/main/ZZINSWARE"},
	{name = "Slap Fights", url = "https://raw.githubusercontent.com/ZZINSWARE/Slap-Fights/refs/heads/main/ZZINSWARE"},
	{name = "Fish For Lucky Blocks", url = "https://raw.githubusercontent.com/ZZINSWARE/Fish-For-Lucky-Blocks/refs/heads/main/ZZINSWARE"},
	{name = "You Vs Homer [Wallhop Practice]", url = "https://raw.githubusercontent.com/ZZINSWARE/You-Vs-Homer-WallHop-Practice-/refs/heads/main/ZZINSWARE"},
	{name = "Anime Slap Tower", url = "https://raw.githubusercontent.com/ZZINSWARE/Anime-Slap-Tower/refs/heads/main/ZZINSWARE"},
	{name = "Chat With Signs", url = "https://raw.githubusercontent.com/ZZINSWARE/Chat-With-Signs/refs/heads/main/ZZINSWARE"}
}

local universalScripts = {
	{name = "Image Logger", url = "https://raw.githubusercontent.com/ZZINSWARE/Image-Logger/refs/heads/main/ZZINSWARE"},
	{name = "Better Console", url = "https://raw.githubusercontent.com/ZZINSWARE/Console/refs/heads/main/ZZINSWARE"},
	{name = "Fake Lag Switch", url = "https://raw.githubusercontent.com/ZZINSWARE/Fake-Lag-switch/refs/heads/main/ZZINSWARE"},
	{name = "Sus R6 Animations", url = "https://raw.githubusercontent.com/ZZINSWARE/Sus-R6/refs/heads/main/ZZINSWARE"},
	{name = "Chat Spammer", url = "https://raw.githubusercontent.com/ZZINSWARE/Chat-Spammer/refs/heads/main/ZZINSWARE"},
	{name = "Chat Bypasser", url = "https://raw.githubusercontent.com/ZZINSWARE/Chat-Bypasser/refs/heads/main/ZZINSWARE"},
	{name = "Fake Wallhop", url = "https://raw.githubusercontent.com/ZZINSWARE/Fake-Wallhop/refs/heads/main/ZZINSWARE"},
	{name = "Anti Tools", url = "https://raw.githubusercontent.com/ZZINSWARE/Anti-Tools/refs/heads/main/ZZINSWARE"},
	{name = "FE Invisible", url = "https://raw.githubusercontent.com/ZZINSWARE/FE-Invisible/refs/heads/main/ZZINSWARE"}
}

local function CreateGameButton(data)
	local Btn = Instance.new("Frame")
	Btn.Size = UDim2.new(1, -10, 0, 50)
	Btn.Position = UDim2.new(0, 5, 0, 0)
	Btn.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	Btn.BorderSizePixel = 0
	Btn.Parent = GameScriptsList
	
	Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 6)
	
	local Title = Instance.new("TextLabel")
	Title.Size = UDim2.new(1, -100, 0, 50)
	Title.Position = UDim2.new(0, 15, 0, 0)
	Title.BackgroundTransparency = 1
	Title.Text = data.name
	Title.TextColor3 = Color3.fromRGB(255, 255, 255)
	Title.TextSize = 14
	Title.Font = Enum.Font.GothamBold
	Title.TextXAlignment = Enum.TextXAlignment.Left
	Title.TextTruncate = Enum.TextTruncate.AtEnd
	Title.Parent = Btn
	
	local ExecBtn = Instance.new("ImageButton")
	ExecBtn.Size = UDim2.new(0, 35, 0, 35)
	ExecBtn.Position = UDim2.new(1, -45, 0, 7)
	ExecBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	ExecBtn.Image = "rbxassetid://119065240115720"
	ExecBtn.ImageColor3 = Color3.fromRGB(255, 255, 255)
	ExecBtn.Parent = Btn
	
	Instance.new("UICorner", ExecBtn).CornerRadius = UDim.new(0, 6)
	
	-- ENHANCED: PC-style tooltip for Execute
	local ExecBtnTooltip = Instance.new("Frame")
	ExecBtnTooltip.Name = "ExecBtnTooltip"
	ExecBtnTooltip.Parent = ExecBtn
	ExecBtnTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
	ExecBtnTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
	ExecBtnTooltip.BorderSizePixel = 1
	ExecBtnTooltip.Position = UDim2.new(0, 0, 0, -28)
	ExecBtnTooltip.Size = UDim2.new(0, 60, 0, 22)
	ExecBtnTooltip.Visible = false
	ExecBtnTooltip.ZIndex = 10

	local ExecBtnTooltipCorner = Instance.new("UICorner")
	ExecBtnTooltipCorner.CornerRadius = UDim.new(0, 4)
	ExecBtnTooltipCorner.Parent = ExecBtnTooltip

	local ExecBtnTooltipText = Instance.new("TextLabel")
	ExecBtnTooltipText.Parent = ExecBtnTooltip
	ExecBtnTooltipText.BackgroundTransparency = 1
	ExecBtnTooltipText.Size = UDim2.new(1, 0, 1, 0)
	ExecBtnTooltipText.Font = Enum.Font.GothamSemibold
	ExecBtnTooltipText.Text = "Execute"
	ExecBtnTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
	ExecBtnTooltipText.TextSize = 11
	ExecBtnTooltipText.ZIndex = 11

	ExecBtn.MouseEnter:Connect(function()
		ExecBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		ExecBtnTooltip.Visible = true
	end)
	ExecBtn.MouseLeave:Connect(function()
		ExecBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
		ExecBtnTooltip.Visible = false
	end)
	
	ExecBtn.MouseButton1Click:Connect(function()
		local success, err = pcall(function()
			loadstring(game:HttpGet(data.url))()
		end)
		if success then
			ShowNotification("Success", "Executed: " .. data.name, "Success", 2)
			game:GetService("StarterGui"):SetCore("SendNotification", {
				Title = "[ðŸ””] ZZINSWARE",
				Text = "Thanks for Using ZZINS Script-Hub.",
				Duration = 5
			})
		else
			ShowNotification("Execution Failed", tostring(err):sub(1, 100), "Error", 5)
		end
	end)
end

local function CreateUniButton(data)
	local Btn = Instance.new("Frame")
	Btn.Size = UDim2.new(1, -10, 0, 50)
	Btn.Position = UDim2.new(0, 5, 0, 0)
	Btn.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	Btn.BorderSizePixel = 0
	Btn.Parent = UniScriptsList
	
	Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 6)
	
	local Title = Instance.new("TextLabel")
	Title.Size = UDim2.new(1, -100, 0, 50)
	Title.Position = UDim2.new(0, 15, 0, 0)
	Title.BackgroundTransparency = 1
	Title.Text = data.name
	Title.TextColor3 = Color3.fromRGB(255, 255, 255)
	Title.TextSize = 14
	Title.Font = Enum.Font.GothamBold
	Title.TextXAlignment = Enum.TextXAlignment.Left
	Title.TextTruncate = Enum.TextTruncate.AtEnd
	Title.Parent = Btn
	
	local ExecBtn = Instance.new("ImageButton")
	ExecBtn.Size = UDim2.new(0, 35, 0, 35)
	ExecBtn.Position = UDim2.new(1, -45, 0, 7)
	ExecBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	ExecBtn.Image = "rbxassetid://119065240115720"
	ExecBtn.ImageColor3 = Color3.fromRGB(255, 255, 255)
	ExecBtn.Parent = Btn
	
	Instance.new("UICorner", ExecBtn).CornerRadius = UDim.new(0, 6)
	
	-- ENHANCED: PC-style tooltip for Execute
	local ExecBtnTooltip = Instance.new("Frame")
	ExecBtnTooltip.Name = "ExecBtnTooltip"
	ExecBtnTooltip.Parent = ExecBtn
	ExecBtnTooltip.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
	ExecBtnTooltip.BorderColor3 = Color3.fromRGB(60, 60, 60)
	ExecBtnTooltip.BorderSizePixel = 1
	ExecBtnTooltip.Position = UDim2.new(0, 0, 0, -28)
	ExecBtnTooltip.Size = UDim2.new(0, 60, 0, 22)
	ExecBtnTooltip.Visible = false
	ExecBtnTooltip.ZIndex = 10

	local ExecBtnTooltipCorner = Instance.new("UICorner")
	ExecBtnTooltipCorner.CornerRadius = UDim.new(0, 4)
	ExecBtnTooltipCorner.Parent = ExecBtnTooltip

	local ExecBtnTooltipText = Instance.new("TextLabel")
	ExecBtnTooltipText.Parent = ExecBtnTooltip
	ExecBtnTooltipText.BackgroundTransparency = 1
	ExecBtnTooltipText.Size = UDim2.new(1, 0, 1, 0)
	ExecBtnTooltipText.Font = Enum.Font.GothamSemibold
	ExecBtnTooltipText.Text = "Execute"
	ExecBtnTooltipText.TextColor3 = Color3.fromRGB(200, 200, 200)
	ExecBtnTooltipText.TextSize = 11
	ExecBtnTooltipText.ZIndex = 11

	ExecBtn.MouseEnter:Connect(function()
		ExecBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
		ExecBtnTooltip.Visible = true
	end)
	ExecBtn.MouseLeave:Connect(function()
		ExecBtn.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
		ExecBtnTooltip.Visible = false
	end)
	
	ExecBtn.MouseButton1Click:Connect(function()
		local success, err = pcall(function()
			loadstring(game:HttpGet(data.url))()
		end)
		if success then
			ShowNotification("Success", "Executed: " .. data.name, "Success", 2)
			game:GetService("StarterGui"):SetCore("SendNotification", {
				Title = "[ðŸ””] ZZINSWARE",
				Text = "Thanks for Using ZZINS Script-Hub.",
				Duration = 5
			})
		else
			ShowNotification("Execution Failed", tostring(err):sub(1, 100), "Error", 5)
		end
	end)
end

local function LoadGameScripts(filter)
	ClearList(GameScriptsList)
	for _, script in pairs(gameScripts) do
		if not filter or script.name:lower():find(filter:lower()) then
			CreateGameButton(script)
		end
	end
	GameScriptsList.CanvasSize = UDim2.new(0, 0, 0, GameListLayout.AbsoluteContentSize.Y + 10)
end

local function LoadUniScripts(filter)
	ClearList(UniScriptsList)
	for _, script in pairs(universalScripts) do
		if not filter or script.name:lower():find(filter:lower()) then
			CreateUniButton(script)
		end
	end
	UniScriptsList.CanvasSize = UDim2.new(0, 0, 0, UniListLayout.AbsoluteContentSize.Y + 10)
end

GameSearchButton.MouseButton1Click:Connect(function()
	LoadGameScripts(GameSearchBox.Text)
end)

GameSearchBox.FocusLost:Connect(function(enterPressed)
	if enterPressed then
		LoadGameScripts(GameSearchBox.Text)
	end
end)

UniSearchButton.MouseButton1Click:Connect(function()
	LoadUniScripts(UniSearchBox.Text)
end)

UniSearchBox.FocusLost:Connect(function(enterPressed)
	if enterPressed then
		LoadUniScripts(UniSearchBox.Text)
	end
end)

LoadGameScripts()
LoadUniScripts()

SwitchTab("Info")
